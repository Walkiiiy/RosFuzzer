{
  "fn_def_list": [
    {
      "fn_code": "int ares_parse_a_reply(const unsigned char *abuf, int alen,\n                       struct hostent **host, struct ares_addrttl *addrttls,\n                       int *naddrttls)\n{\n  struct ares_addrinfo ai;\n  char                *question_hostname = NULL;\n  ares_status_t        status;\n  size_t               req_naddrttls = 0;\n  ares_dns_record_t   *dnsrec        = NULL;\n\n  if (alen < 0) {\n    return ARES_EBADRESP;\n  }\n\n  if (naddrttls) {\n    req_naddrttls = (size_t)*naddrttls;\n    *naddrttls    = 0;\n  }\n\n  memset(&ai, 0, sizeof(ai));\n\n  status = ares_dns_parse(abuf, (size_t)alen, 0, &dnsrec);\n  if (status != ARES_SUCCESS) {\n    goto fail;\n  }\n\n  status = ares_parse_into_addrinfo(dnsrec, 0, 0, &ai);\n  if (status != ARES_SUCCESS && status != ARES_ENODATA) {\n    goto fail;\n  }\n\n  if (host != NULL) {\n    *host  = NULL;\n    status = ares_addrinfo2hostent(&ai, AF_INET, host);\n    if (status != ARES_SUCCESS && status != ARES_ENODATA) {\n      goto fail; /* LCOV_EXCL_LINE: DefensiveCoding */\n    }\n  }\n\n  if (addrttls != NULL && req_naddrttls) {\n    size_t temp_naddrttls = 0;\n    ares_addrinfo2addrttl(&ai, AF_INET, req_naddrttls, addrttls, NULL,\n                          &temp_naddrttls);\n    *naddrttls = (int)temp_naddrttls;\n  }\n\n\nfail:\n  ares_freeaddrinfo_cnames(ai.cnames);\n  ares_freeaddrinfo_nodes(ai.nodes);\n  ares_free(ai.name);\n  ares_free(question_hostname);\n  ares_dns_record_destroy(dnsrec);\n\n  if (status == ARES_EBADNAME) {\n    status = ARES_EBADRESP;\n  }\n\n  return (int)status;\n}",
      "fn_code_pos": [
        [
          47,
          0
        ],
        [
          106,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "ares_parse_a_reply",
        "parameters": {
          "abuf": "unsigned char",
          "alen": "int",
          "host": "struct hostent",
          "addrttls": "struct ares_addrttl",
          "naddrttls": "int"
        },
        "return_type": "int"
      }
    }
  ],
  "fn_declaraion": [],
  "class_node_list": {},
  "struct_node_list": [
    [
      "struct hostent",
      {},
      "",
      [
        48,
        23
      ],
      [
        48,
        37
      ]
    ],
    [
      "struct ares_addrttl",
      {},
      "",
      [
        48,
        46
      ],
      [
        48,
        65
      ]
    ],
    [
      "struct ares_addrinfo",
      {},
      "",
      [
        51,
        2
      ],
      [
        51,
        22
      ]
    ]
  ],
  "include_list": [
    [
      "#include \"ares_private.h\"\n",
      [
        27,
        0
      ],
      [
        28,
        0
      ]
    ],
    [
      "#  include <netinet/in.h>\n",
      [
        30,
        0
      ],
      [
        31,
        0
      ]
    ],
    [
      "#  include <netdb.h>\n",
      [
        33,
        0
      ],
      [
        34,
        0
      ]
    ],
    [
      "#  include <arpa/inet.h>\n",
      [
        36,
        0
      ],
      [
        37,
        0
      ]
    ],
    [
      "#  include <strings.h>\n",
      [
        40,
        0
      ],
      [
        41,
        0
      ]
    ],
    [
      "#  include <limits.h>\n",
      [
        44,
        0
      ],
      [
        45,
        0
      ]
    ]
  ],
  "global_variables": [],
  "enumerate_node_list": []
}