{
  "fn_def_list": [
    {
      "fn_code": "TEST_F(LibraryTest, StringLength) {\n  const char data[] = \"test\\0test\";\n  size_t n = sizeof data;\n  for(size_t i = 0; i < n; ++i) {\n    EXPECT_EQ(ares_strlen(&data[i]), ares_strnlen(&data[i], n - i));\n  }\n}",
      "fn_code_pos": [
        [
          65,
          0
        ],
        [
          71,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, StringLengthNullPointer) {\n  EXPECT_EQ(ares_strlen(NULL), 0);\n  EXPECT_EQ(ares_strnlen(NULL, 0), 0);\n  EXPECT_EQ(ares_strnlen(NULL, 1), 0);\n  EXPECT_EQ(ares_strnlen(NULL, 42), 0);\n}",
      "fn_code_pos": [
        [
          73,
          0
        ],
        [
          78,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, StringLengthWithoutNullTerminator) {\n  std::string data = \"test\";\n  for(size_t i = 0; i < data.length(); ++i) {\n    EXPECT_EQ(ares_strnlen(data.c_str(), i), i);\n  }\n}",
      "fn_code_pos": [
        [
          80,
          0
        ],
        [
          85,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "void CheckPtoN4(int size, unsigned int value, const char *input) {\n  struct in_addr a4;\n  a4.s_addr = 0;\n  uint32_t expected = htonl(value);\n  EXPECT_EQ(size, ares_inet_net_pton(AF_INET, input, &a4, sizeof(a4)))\n    << \" for input \" << input;\n  EXPECT_EQ(expected, a4.s_addr) << \" for input \" << input;\n}",
      "fn_code_pos": [
        [
          87,
          0
        ],
        [
          94,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "CheckPtoN4",
        "parameters": {
          "size": "int",
          "value": "unsigned int",
          "input": "char"
        },
        "return_type": "void"
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, Strsplit) {\n  using std::vector;\n  using std::string;\n  size_t n;\n  struct {\n    vector<string> inputs;\n    vector<string> delimiters;\n    vector<vector<string>> expected;\n  } data = {\n    {\n      \"\",\n      \" \",\n      \"             \",\n      \"example.com, example.co\",\n      \"        a, b, A,c,     d, e,,,D,e,e,E\",\n    },\n    { \", \", \", \", \", \", \", \", \", \" },\n    {\n      {}, {}, {},\n      { \"example.com\", \"example.co\" },\n      { \"a\", \"b\", \"c\", \"d\", \"e\" },\n    },\n  };\n  for(size_t i = 0; i < data.inputs.size(); i++) {\n    char **out = ares_strsplit(data.inputs.at(i).c_str(),\n                               data.delimiters.at(i).c_str(), &n);\n    if(data.expected.at(i).size() == 0) {\n      EXPECT_EQ(out, nullptr);\n    }\n    else {\n      EXPECT_EQ(n, data.expected.at(i).size());\n      for(size_t j = 0; j < n && j < data.expected.at(i).size(); j++) {\n        EXPECT_STREQ(out[j], data.expected.at(i).at(j).c_str());\n      }\n    }\n    ares_strsplit_free(out, n);\n  }\n}",
      "fn_code_pos": [
        [
          96,
          0
        ],
        [
          133,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, InetNetPtoN) {\n  uint32_t expected;\n  struct in_addr a4;\n  struct in6_addr a6;\n  CheckPtoN4(4 * 8, 0x01020304, \"1.2.3.4\");\n  CheckPtoN4(4 * 8, 0x81010101, \"129.1.1.1\");\n  CheckPtoN4(4 * 8, 0xC0010101, \"192.1.1.1\");\n  CheckPtoN4(4 * 8, 0xE0010101, \"224.1.1.1\");\n  CheckPtoN4(4 * 8, 0xE1010101, \"225.1.1.1\");\n  CheckPtoN4(4, 0xE0000000, \"224\");\n  CheckPtoN4(4 * 8, 0xFD000000, \"253\");\n  CheckPtoN4(4 * 8, 0xF0010101, \"240.1.1.1\");\n  CheckPtoN4(4 * 8, 0x02030405, \"02.3.4.5\");\n  CheckPtoN4(3 * 8, 0x01020304, \"1.2.3.4/24\");\n  CheckPtoN4(3 * 8, 0x01020300, \"1.2.3/24\");\n  CheckPtoN4(2 * 8, 0xa0000000, \"0xa\");\n  CheckPtoN4(0, 0x02030405, \"2.3.4.5/000\");\n  CheckPtoN4(1 * 8, 0x01020000, \"1.2/8\");\n  CheckPtoN4(2 * 8, 0x01020000, \"0x0102/16\");\n  CheckPtoN4(4 * 8, 0x02030405, \"02.3.4.5\");\n\n  // Partially specified\n  // (ensures 4 octets are properly zeroed)\n  a4.s_addr = 0xFFFFFFFF;\n  ares_inet_net_pton(AF_INET, \"10/8\", &a4, sizeof(a4));\n  EXPECT_EQ(htonl(0x0A000000), a4.s_addr);\n\n  EXPECT_EQ(16 * 8, ares_inet_net_pton(AF_INET6, \"::\", &a6, sizeof(a6)));\n  EXPECT_EQ(16 * 8, ares_inet_net_pton(AF_INET6, \"::1\", &a6, sizeof(a6)));\n  EXPECT_EQ(16 * 8, ares_inet_net_pton(AF_INET6, \"1234:5678::\", &a6, sizeof(a6)));\n  EXPECT_EQ(16 * 8, ares_inet_net_pton(AF_INET6, \"12:34::ff\", &a6, sizeof(a6)));\n  EXPECT_EQ(16 * 8, ares_inet_net_pton(AF_INET6, \"12:34::ffff:1.2.3.4\", &a6, sizeof(a6)));\n  EXPECT_EQ(23, ares_inet_net_pton(AF_INET6, \"12:34::ffff:1.2.3.4/23\", &a6, sizeof(a6)));\n  EXPECT_EQ(3 * 8, ares_inet_net_pton(AF_INET6, \"12:34::ff/24\", &a6, sizeof(a6)));\n  EXPECT_EQ(0, ares_inet_net_pton(AF_INET6, \"12:34::ff/0\", &a6, sizeof(a6)));\n  EXPECT_EQ(16 * 8, ares_inet_net_pton(AF_INET6, \"12:34::ffff:0.2\", &a6, sizeof(a6)));\n  EXPECT_EQ(16 * 8, ares_inet_net_pton(AF_INET6, \"1234:1234:1234:1234:1234:1234:1234:1234\", &a6, sizeof(a6)));\n  EXPECT_EQ(2, ares_inet_net_pton(AF_INET6, \"0::00:00:00/2\", &a6, sizeof(a6)));\n\n  // Various malformed versions\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \" \", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"0x\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"0x \", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"x0\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"0xXYZZY\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"xyzzy\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET+AF_INET6, \"1.2.3.4\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"257.2.3.4\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"002.3.4.x\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"00.3.4.x\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"2.3.4.x\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"2.3.4.5.6\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"2.3.4.5.6/12\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"2.3.4:5\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"2.3.4.5/120\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"2.3.4.5/1x\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"2.3.4.5/x\", &a4, sizeof(a4)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ff/240\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ff/02\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ff/2y\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ff/y\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ff/\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \":x\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \":\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \": :1234\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"::12345\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"1234::2345:3456::0011\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"1234:1234:1234:1234:1234:1234:1234:1234:\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"1234:1234:1234:1234:1234:1234:1234:1234::\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"1234:1234:1234:1234:1234:1234:1234:1.2.3.4\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \":1234:1234:1234:1234:1234:1234:1234:1234\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \":1234:1234:1234:1234:1234:1234:1234:1234:\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"1234:1234:1234:1234:1234:1234:1234:1234:5678\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"1234:1234:1234:1234:1234:1234:1234:1234:5678:5678\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"1234:1234:1234:1234:1234:1234:1234:1234:5678:5678:5678\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ffff:257.2.3.4\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ffff:1.2.3.4.5.6\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ffff:1.2.3.4.5\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ffff:1.2.3.z\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ffff:1.2.3001.4\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ffff:1.2.3..4\", &a6, sizeof(a6)));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ffff:1.2.3.\", &a6, sizeof(a6)));\n\n  // Hex constants are allowed.\n  EXPECT_EQ(4 * 8, ares_inet_net_pton(AF_INET, \"0x01020304\", &a4, sizeof(a4)));\n  expected = htonl(0x01020304);\n  EXPECT_EQ(expected, a4.s_addr);\n  EXPECT_EQ(4 * 8, ares_inet_net_pton(AF_INET, \"0x0a0b0c0d\", &a4, sizeof(a4)));\n  expected = htonl(0x0a0b0c0d);\n  EXPECT_EQ(expected, a4.s_addr);\n  EXPECT_EQ(4 * 8, ares_inet_net_pton(AF_INET, \"0x0A0B0C0D\", &a4, sizeof(a4)));\n  expected = htonl(0x0a0b0c0d);\n  EXPECT_EQ(expected, a4.s_addr);\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"0x0xyz\", &a4, sizeof(a4)));\n  EXPECT_EQ(4 * 8, ares_inet_net_pton(AF_INET, \"0x1122334\", &a4, sizeof(a4)));\n  expected = htonl(0x11223340);\n  EXPECT_EQ(expected, a4.s_addr);  // huh?\n\n  // No room, no room.\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"1.2.3.4\", &a4, sizeof(a4) - 1));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET6, \"12:34::ff\", &a6, sizeof(a6) - 1));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"0x01020304\", &a4, 2));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"0x01020304\", &a4, 0));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"0x0a0b0c0d\", &a4, 0));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"0x0xyz\", &a4, 0));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"0x1122334\", &a4, sizeof(a4) - 1));\n  EXPECT_EQ(-1, ares_inet_net_pton(AF_INET, \"253\", &a4, sizeof(a4) - 1));\n}",
      "fn_code_pos": [
        [
          135,
          0
        ],
        [
          244,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, FreeLongChain) {\n  struct ares_addr_node *data = nullptr;\n  for (int ii = 0; ii < 100000; ii++) {\n    struct ares_addr_node *prev = (struct ares_addr_node*)ares_malloc_data(ARES_DATATYPE_ADDR_NODE);\n    prev->next = data;\n    data = prev;\n  }\n\n  ares_free_data(data);\n}",
      "fn_code_pos": [
        [
          246,
          0
        ],
        [
          255,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, MallocDataFail) {\n  EXPECT_EQ(nullptr, ares_malloc_data((ares_datatype)99));\n  SetAllocSizeFail(sizeof(struct ares_data));\n  EXPECT_EQ(nullptr, ares_malloc_data(ARES_DATATYPE_MX_REPLY));\n}",
      "fn_code_pos": [
        [
          257,
          0
        ],
        [
          261,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(Misc, OnionDomain) {\n  EXPECT_EQ(0, ares_is_onion_domain(\"onion.no\"));\n  EXPECT_EQ(0, ares_is_onion_domain(\".onion.no\"));\n  EXPECT_EQ(1, ares_is_onion_domain(\".onion\"));\n  EXPECT_EQ(1, ares_is_onion_domain(\".onion.\"));\n  EXPECT_EQ(1, ares_is_onion_domain(\"yes.onion\"));\n  EXPECT_EQ(1, ares_is_onion_domain(\"yes.onion.\"));\n  EXPECT_EQ(1, ares_is_onion_domain(\"YES.ONION\"));\n  EXPECT_EQ(1, ares_is_onion_domain(\"YES.ONION.\"));\n}",
      "fn_code_pos": [
        [
          263,
          0
        ],
        [
          272,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, CatDomain) {\n  char *s;\n\n  ares_cat_domain(\"foo\", \"example.net\", &s);\n  EXPECT_STREQ(\"foo.example.net\", s);\n  ares_free(s);\n\n  ares_cat_domain(\"foo\", \".\", &s);\n  EXPECT_STREQ(\"foo.\", s);\n  ares_free(s);\n\n  ares_cat_domain(\"foo\", \"example.net.\", &s);\n  EXPECT_STREQ(\"foo.example.net.\", s);\n  ares_free(s);\n}",
      "fn_code_pos": [
        [
          274,
          0
        ],
        [
          288,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, SlistMisuse) {\n  EXPECT_EQ(NULL, ares_slist_create(NULL, NULL, NULL));\n  ares_slist_replace_destructor(NULL, NULL);\n  EXPECT_EQ(NULL, ares_slist_insert(NULL, NULL));\n  EXPECT_EQ(NULL, ares_slist_node_find(NULL, NULL));\n  EXPECT_EQ(NULL, ares_slist_node_first(NULL));\n  EXPECT_EQ(NULL, ares_slist_node_last(NULL));\n  EXPECT_EQ(NULL, ares_slist_node_next(NULL));\n  EXPECT_EQ(NULL, ares_slist_node_prev(NULL));\n  EXPECT_EQ(NULL, ares_slist_node_val(NULL));\n  EXPECT_EQ((size_t)0, ares_slist_len(NULL));\n  EXPECT_EQ(NULL, ares_slist_node_parent(NULL));\n  EXPECT_EQ(NULL, ares_slist_first_val(NULL));\n  EXPECT_EQ(NULL, ares_slist_last_val(NULL));\n  EXPECT_EQ(NULL, ares_slist_node_claim(NULL));\n}",
      "fn_code_pos": [
        [
          290,
          0
        ],
        [
          305,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, IfaceIPs) {\n  ares_status_t      status;\n  ares_iface_ips_t *ips = NULL;\n  size_t             i;\n\n  status = ares_iface_ips(&ips, ARES_IFACE_IP_DEFAULT, NULL);\n  EXPECT_TRUE(status == ARES_SUCCESS || status == ARES_ENOTIMP);\n\n  /* Not implemented, can't run tests */\n  if (status == ARES_ENOTIMP)\n    return;\n\n  EXPECT_NE(nullptr, ips);\n\n  for (i=0; i<ares_iface_ips_cnt(ips); i++) {\n    const char *name = ares_iface_ips_get_name(ips, i);\n    EXPECT_NE(nullptr, name);\n    int flags = (int)ares_iface_ips_get_flags(ips, i);\n    EXPECT_NE(0, (int)flags);\n    EXPECT_NE(nullptr, ares_iface_ips_get_addr(ips, i));\n    EXPECT_NE(0, ares_iface_ips_get_netmask(ips, i));\n    if (flags & ARES_IFACE_IP_LINKLOCAL && flags & ARES_IFACE_IP_V6) {\n      /* Hmm, seems not to work at least on MacOS\n       * EXPECT_NE(0, ares_iface_ips_get_ll_scope(ips, i));\n       */\n    } else {\n      EXPECT_EQ(0, ares_iface_ips_get_ll_scope(ips, i));\n    }\n    unsigned int idx = ares_os_if_nametoindex(name);\n    EXPECT_NE(0, idx);\n    char namebuf[256];\n    EXPECT_EQ(std::string(ares_os_if_indextoname(idx, namebuf, sizeof(namebuf))), std::string(name));\n  }\n\n\n  /* Negative checking */\n  ares_iface_ips_get_name(ips, ares_iface_ips_cnt(ips));\n  ares_iface_ips_get_flags(ips, ares_iface_ips_cnt(ips));\n  ares_iface_ips_get_addr(ips, ares_iface_ips_cnt(ips));\n  ares_iface_ips_get_netmask(ips, ares_iface_ips_cnt(ips));\n  ares_iface_ips_get_ll_scope(ips, ares_iface_ips_cnt(ips));\n\n  ares_iface_ips(NULL, ARES_IFACE_IP_DEFAULT, NULL);\n  ares_iface_ips_cnt(NULL);\n  ares_iface_ips_get_name(NULL, 0);\n  ares_iface_ips_get_flags(NULL, 0);\n  ares_iface_ips_get_addr(NULL, 0);\n  ares_iface_ips_get_netmask(NULL, 0);\n  ares_iface_ips_get_ll_scope(NULL, 0);\n  ares_iface_ips_destroy(NULL);\n  ares_os_if_nametoindex(NULL);\n  ares_os_if_indextoname(0, NULL, 0);\n\n  ares_iface_ips_destroy(ips);\n}",
      "fn_code_pos": [
        [
          308,
          0
        ],
        [
          362,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableMisuse) {\n  EXPECT_EQ(NULL, ares_htable_create(NULL, NULL, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_insert(NULL, NULL));\n  EXPECT_EQ(NULL, ares_htable_get(NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_remove(NULL, NULL));\n  EXPECT_EQ((size_t)0, ares_htable_num_keys(NULL));\n}",
      "fn_code_pos": [
        [
          365,
          0
        ],
        [
          371,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, URI) {\n  struct {\n    ares_bool_t success;\n    const char *uri;\n    const char *alt_match_uri;\n  } tests[] = {\n    { ARES_TRUE,  \"https://www.example.com\",                                                               NULL },\n    { ARES_TRUE,  \"https://www.example.com:8443\",                                                          NULL },\n    { ARES_TRUE,  \"https://user:password@www.example.com\",                                                 NULL },\n    { ARES_TRUE,  \"https://user%25:password@www.example.com\",                                              NULL },\n    { ARES_TRUE,  \"https://user:password%25@www.example.com\",                                              NULL },\n    { ARES_TRUE,  \"https://user@www.example.com\",                                                          NULL },\n    { ARES_TRUE,  \"https://www.example.com/path\",                                                          NULL },\n    { ARES_TRUE,  \"https://www.example.com/path/\",                                                         NULL },\n    { ARES_TRUE,  \"https://www.example.com/a/../\",                                                         \"https://www.example.com/\" },\n    { ARES_TRUE,  \"https://www.example.com/../a/\",                                                         \"https://www.example.com/a/\" },\n    { ARES_TRUE,  \"https://www.example.com/.././../a/\",                                                    \"https://www.example.com/a/\" },\n    { ARES_TRUE,  \"https://www.example.com/.././../a//b/c/d/../../\",                                       \"https://www.example.com/a/b/\" },\n    { ARES_TRUE,  \"https://www.example.com?key=val\",                                                       NULL },\n    { ARES_TRUE,  \"https://www.example.com?key\",                                                           NULL },\n    { ARES_TRUE,  \"https://www.example.com?key=\",                                                          \"https://www.example.com?key\" },\n    { ARES_TRUE,  \"https://www.example.com#fragment\",                                                      NULL },\n    { ARES_TRUE,  \"https://user:password@www.example.com/path\",                                            NULL },\n    { ARES_TRUE,  \"https://user:password@www.example.com/path#fragment\",                                   NULL },\n    { ARES_TRUE,  \"https://user:password@www.example.com/path?key=val\",                                    NULL },\n    { ARES_TRUE,  \"https://user:password@www.example.com/path?key=val#fragment\",                           NULL },\n    { ARES_TRUE,  \"https://user:password@www.example.com/path?key=val#fragment/with?chars\",                NULL },\n    { ARES_TRUE,  \"HTTPS://www.example.com\",                                                               \"https://www.example.com\" },\n    { ARES_TRUE,  \"https://www.example.com?key=hello+world\",                                               \"https://www.example.com?key=hello%20world\" },\n    { ARES_TRUE,  \"https://www.example.com?key=val%26\",                                                    NULL },\n    { ARES_TRUE,  \"https://www.example.com?key%26=val\",                                                    NULL },\n    { ARES_TRUE,  \"https://www.example.com?key=Aa2-._~/?!$'()*,;:@\",                                       NULL },\n    { ARES_TRUE,  \"https://www.example.com?key1=val1&key2=val2&key3=val3&key4=val4\",                       \"ignore\" }, /* keys get randomized, can't match */\n    { ARES_TRUE,  \"https://www.example.com?key=%41%61%32%2D%2E%5f%7e%2F%3F%21%24%27%28%29%2a%2C%3b%3a%40\", \"https://www.example.com?key=Aa2-._~/?!$'()*,;:@\" },\n    { ARES_TRUE,  \"dns+tls://192.168.1.1:53\",                                                              NULL },\n    { ARES_TRUE,  \"dns+tls://[fe80::1]:53\",                                                                NULL },\n    { ARES_TRUE,  \"dns://[fe80::b542:84df:1719:65e3%en0]\",                                                 NULL },\n    { ARES_TRUE,  \"dns+tls://[fe80:00::00:1]:53\",                                                          \"dns+tls://[fe80::1]:53\" },\n    { ARES_TRUE,  \"d.n+s-tls://www.example.com\",                                                           NULL },\n    { ARES_FALSE, \"dns*tls://www.example.com\",                                                             NULL }, /* invalid scheme character */\n    { ARES_FALSE, \"0dns://www.example.com\",                                                                NULL }, /* dns can't start with digits */\n    { ARES_FALSE, \"https://www.example.com?key=val%01\",                                                    NULL }, /* non-printable character */\n    { ARES_FALSE, \"abcdef0123456789://www.example.com\",                                                    NULL }, /* scheme too long */\n    { ARES_FALSE, \"www.example.com\",                                                                       NULL }, /* missing scheme */\n    { ARES_FALSE, \"https://www.example.com?key=val%0\",                                                     NULL }, /* truncated uri-encoding */\n    { ARES_FALSE, \"https://www.example.com?key=val%AZ\",                                                    NULL }, /* invalid uri-encoding sequence */\n    { ARES_FALSE, \"https://www.example.com?key=hello world\",                                               NULL }, /* invalid character in query value */\n    { ARES_FALSE, \"https://:password@www.example.com\",                                                     NULL }, /* can't have password without username */\n    { ARES_FALSE, \"dns+tls://[fe8G::1]\",                                                                   NULL }, /* invalid ipv6 address */\n\n    { ARES_FALSE, NULL, NULL }\n  };\n  size_t i;\n\n  for (i=0; tests[i].uri != NULL; i++) {\n    ares_uri_t *uri = NULL;\n    ares_status_t status;\n\n    if (verbose) std::cerr << \"Testing \" << tests[i].uri << std::endl;\n    status = ares_uri_parse(&uri, tests[i].uri);\n    if (tests[i].success) {\n      EXPECT_EQ(ARES_SUCCESS, status);\n    } else {\n      EXPECT_NE(ARES_SUCCESS, status);\n    }\n\n    if (status == ARES_SUCCESS) {\n      char *out = NULL;\n      EXPECT_EQ(ARES_SUCCESS, ares_uri_write(&out, uri));\n      if (tests[i].alt_match_uri == NULL || strcmp(tests[i].alt_match_uri, \"ignore\") != 0) {\n        EXPECT_STRCASEEQ(tests[i].alt_match_uri == NULL?tests[i].uri:tests[i].alt_match_uri, out);\n      }\n      ares_free(out);\n    }\n    ares_uri_destroy(uri);\n  }\n\n  /* Invalid tests  */\n  EXPECT_NE(ARES_SUCCESS, ares_uri_set_scheme(NULL, NULL));\n  EXPECT_EQ(nullptr, ares_uri_get_scheme(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_set_username(NULL, NULL));\n  EXPECT_EQ(nullptr, ares_uri_get_username(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_set_password(NULL, NULL));\n  EXPECT_EQ(nullptr, ares_uri_get_password(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_set_host(NULL, NULL));\n  EXPECT_EQ(nullptr, ares_uri_get_host(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_set_port(NULL, 0));\n  EXPECT_EQ(0, ares_uri_get_port(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_set_path(NULL, NULL));\n  EXPECT_EQ(nullptr, ares_uri_get_path(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_set_query_key(NULL, NULL, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_del_query_key(NULL, NULL));\n  EXPECT_EQ(nullptr, ares_uri_get_query_key(NULL, NULL));\n  EXPECT_EQ(nullptr, ares_uri_get_query_keys(NULL, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_set_fragment(NULL, NULL));\n  EXPECT_EQ(nullptr, ares_uri_get_fragment(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_write_buf(NULL, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_write(NULL, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_parse_buf(NULL, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_uri_parse_buf(NULL, NULL));\n}",
      "fn_code_pos": [
        [
          373,
          0
        ],
        [
          473,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, InetPtoN) {\n  struct in_addr a4;\n  struct in6_addr a6;\n  EXPECT_EQ(1, ares_inet_pton(AF_INET, \"1.2.3.4\", &a4));\n  EXPECT_EQ(1, ares_inet_pton(AF_INET6, \"12:34::ff\", &a6));\n  EXPECT_EQ(1, ares_inet_pton(AF_INET6, \"12:34::ffff:1.2.3.4\", &a6));\n  EXPECT_EQ(0, ares_inet_pton(AF_INET, \"xyzzy\", &a4));\n  EXPECT_EQ(-1, ares_inet_pton(AF_INET+AF_INET6, \"1.2.3.4\", &a4));\n}",
      "fn_code_pos": [
        [
          476,
          0
        ],
        [
          484,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, FreeCorruptData) {\n  // ares_free_data(p) expects that there is a type field and a marker\n  // field in the memory before p.  Feed it incorrect versions of each.\n  struct ares_data *data = (struct ares_data *)malloc(sizeof(struct ares_data));\n  void* p = &(data->data);\n\n  // Invalid type\n  data->type = (ares_datatype)ARES_DATATYPE_LAST;\n  data->mark = ARES_DATATYPE_MARK;\n  ares_free_data(p);\n\n  // Invalid marker\n  data->type = (ares_datatype)ARES_DATATYPE_MX_REPLY;\n  data->mark = ARES_DATATYPE_MARK + 1;\n  ares_free_data(p);\n\n  // Null pointer\n  ares_free_data(nullptr);\n\n  free(data);\n}",
      "fn_code_pos": [
        [
          486,
          0
        ],
        [
          506,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(LibraryInit, StrdupFailures) {\n  EXPECT_EQ(ARES_SUCCESS, ares_library_init(ARES_LIB_INIT_ALL));\n  char* copy = ares_strdup(\"string\");\n  EXPECT_NE(nullptr, copy);\n  ares_free(copy);\n  ares_library_cleanup();\n}",
      "fn_code_pos": [
        [
          508,
          0
        ],
        [
          514,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, StrdupFailures) {\n  SetAllocFail(1);\n  char* copy = ares_strdup(\"string\");\n  EXPECT_EQ(nullptr, copy);\n}",
      "fn_code_pos": [
        [
          516,
          0
        ],
        [
          520,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(FileChannelTest, GetAddrInfoHostsPositive) {\n  TempFile hostsfile(\"1.2.3.4 example.com  \\n\"\n                     \"  2.3.4.5\\tgoogle.com   www.google.com\\twww2.google.com\\n\"\n                     \"#comment\\n\"\n                     \"4.5.6.7\\n\"\n                     \"1.3.5.7  \\n\"\n                     \"::1    ipv6.com\");\n  EnvValue with_env(\"CARES_HOSTS\", hostsfile.filename());\n  struct ares_addrinfo_hints hints = {0, 0, 0, 0};\n  AddrInfoResult result = {};\n  hints.ai_family = AF_INET;\n  hints.ai_flags = ARES_AI_CANONNAME | ARES_AI_ENVHOSTS | ARES_AI_NOSORT;\n  ares_getaddrinfo(channel_, \"example.com\", NULL, &hints, AddrInfoCallback, &result);\n  Process();\n  EXPECT_TRUE(result.done_);\n  std::stringstream ss;\n  ss << result.ai_;\n  EXPECT_EQ(\"{example.com addr=[1.2.3.4]}\", ss.str());\n}",
      "fn_code_pos": [
        [
          522,
          0
        ],
        [
          540,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(FileChannelTest, GetAddrInfoHostsSpaces) {\n  TempFile hostsfile(\"1.2.3.4 example.com  \\n\"\n                     \"  2.3.4.5\\tgoogle.com   www.google.com\\twww2.google.com\\n\"\n                     \"#comment\\n\"\n                     \"4.5.6.7\\n\"\n                     \"1.3.5.7  \\n\"\n                     \"::1    ipv6.com\");\n  EnvValue with_env(\"CARES_HOSTS\", hostsfile.filename());\n  struct ares_addrinfo_hints hints = {0, 0, 0, 0};\n  AddrInfoResult result = {};\n  hints.ai_family = AF_INET;\n  hints.ai_flags = ARES_AI_CANONNAME | ARES_AI_ENVHOSTS | ARES_AI_NOSORT;\n  ares_getaddrinfo(channel_, \"google.com\", NULL, &hints, AddrInfoCallback, &result);\n  Process();\n  EXPECT_TRUE(result.done_);\n  std::stringstream ss;\n  ss << result.ai_;\n  EXPECT_EQ(\"{www.google.com->google.com, www2.google.com->google.com addr=[2.3.4.5]}\", ss.str());\n}",
      "fn_code_pos": [
        [
          542,
          0
        ],
        [
          560,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(FileChannelTest, GetAddrInfoHostsByALias) {\n  TempFile hostsfile(\"1.2.3.4 example.com  \\n\"\n                     \"  2.3.4.5\\tgoogle.com   www.google.com\\twww2.google.com\\n\"\n                     \"#comment\\n\"\n                     \"4.5.6.7\\n\"\n                     \"1.3.5.7  \\n\"\n                     \"::1    ipv6.com\");\n  EnvValue with_env(\"CARES_HOSTS\", hostsfile.filename());\n  struct ares_addrinfo_hints hints = {0, 0, 0, 0};\n  AddrInfoResult result = {};\n  hints.ai_family = AF_INET;\n  hints.ai_flags = ARES_AI_CANONNAME | ARES_AI_ENVHOSTS | ARES_AI_NOSORT;\n  ares_getaddrinfo(channel_, \"www2.google.com\", NULL, &hints, AddrInfoCallback, &result);\n  Process();\n  EXPECT_TRUE(result.done_);\n  std::stringstream ss;\n  ss << result.ai_;\n  EXPECT_EQ(\"{www.google.com->google.com, www2.google.com->google.com addr=[2.3.4.5]}\", ss.str());\n}",
      "fn_code_pos": [
        [
          562,
          0
        ],
        [
          580,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(FileChannelTest, GetAddrInfoHostsIPV6) {\n  TempFile hostsfile(\"1.2.3.4 example.com  \\n\"\n                     \"  2.3.4.5\\tgoogle.com   www.google.com\\twww2.google.com\\n\"\n                     \"#comment\\n\"\n                     \"4.5.6.7\\n\"\n                     \"1.3.5.7  \\n\"\n                     \"::1    ipv6.com\");\n  EnvValue with_env(\"CARES_HOSTS\", hostsfile.filename());\n  struct ares_addrinfo_hints hints = {0, 0, 0, 0};\n  AddrInfoResult result = {};\n  hints.ai_family = AF_INET6;\n  hints.ai_flags = ARES_AI_CANONNAME | ARES_AI_ENVHOSTS | ARES_AI_NOSORT;\n  ares_getaddrinfo(channel_, \"ipv6.com\", NULL, &hints, AddrInfoCallback, &result);\n  Process();\n  EXPECT_TRUE(result.done_);\n  std::stringstream ss;\n  ss << result.ai_;\n  EXPECT_EQ(\"{ipv6.com addr=[[0000:0000:0000:0000:0000:0000:0000:0001]]}\", ss.str());\n}",
      "fn_code_pos": [
        [
          582,
          0
        ],
        [
          600,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(FileChannelTest, GetAddrInfoInvalidService) {\n  TempFile hostsfile(\"1.2.3.4 example.com\");\n  EnvValue with_env(\"CARES_HOSTS\", hostsfile.filename());\n  struct ares_addrinfo_hints hints{};\n  AddrInfoResult result{};\n  hints.ai_family = AF_INET;\n  hints.ai_flags = ARES_AI_CANONNAME | ARES_AI_ENVHOSTS | ARES_AI_NOSORT;\n  ares_getaddrinfo(channel_, \"example.com\", \"invalid\", &hints, AddrInfoCallback, &result);\n  Process();\n  EXPECT_TRUE(result.done_);\n  EXPECT_EQ(result.status_, ARES_ESERVICE);\n}",
      "fn_code_pos": [
        [
          602,
          0
        ],
        [
          613,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(FileChannelTest, GetAddrInfoAllocFail) {\n  TempFile hostsfile(\"1.2.3.4 example.com alias1 alias2\\n\");\n  EnvValue with_env(\"CARES_HOSTS\", hostsfile.filename());\n  struct ares_addrinfo_hints hints;\n\n  memset(&hints, 0, sizeof(hints));\n  hints.ai_family = AF_INET;\n\n  // Fail a variety of different memory allocations, and confirm\n  // that the operation either fails with ENOMEM or succeeds\n  // with the expected result.\n  const int kCount = 34;\n  AddrInfoResult results[kCount];\n  for (int ii = 1; ii <= kCount; ii++) {\n    AddrInfoResult* result = &(results[ii - 1]);\n    ClearFails();\n    SetAllocFail(ii);\n    ares_getaddrinfo(channel_, \"example.com\", NULL, &hints, AddrInfoCallback, result);\n    Process();\n    EXPECT_TRUE(result->done_);\n    if (result->status_ == ARES_SUCCESS) {\n      std::stringstream ss;\n      ss << result->ai_;\n      EXPECT_EQ(\"{alias1->example.com, alias2->example.com addr=[1.2.3.4]}\", ss.str()) << \" failed alloc #\" << ii;\n      if (verbose) std::cerr << \"Succeeded despite failure of alloc #\" << ii << std::endl;\n    }\n  }\n}",
      "fn_code_pos": [
        [
          615,
          0
        ],
        [
          642,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, DNSRecord) {\n  ares_dns_record_t   *dnsrec = NULL;\n  ares_dns_rr_t       *rr     = NULL;\n  struct in_addr       addr;\n  struct ares_in6_addr addr6;\n  unsigned char       *msg    = NULL;\n  size_t               msglen = 0;\n  size_t               qdcount = 0;\n  size_t               ancount = 0;\n  size_t               nscount = 0;\n  size_t               arcount = 0;\n\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_create(&dnsrec, 0x1234,\n      ARES_FLAG_QR|ARES_FLAG_AA|ARES_FLAG_RD|ARES_FLAG_RA,\n      ARES_OPCODE_QUERY, ARES_RCODE_NOERROR));\n\n  /* == Question == */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_query_add(dnsrec, \"example.com\",\n      ARES_REC_TYPE_ANY,\n      ARES_CLASS_IN));\n\n  /* == Answer == */\n  /* A */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ANSWER, \"example.com\",\n      ARES_REC_TYPE_A, ARES_CLASS_IN, 300));\n  EXPECT_LT(0, ares_inet_pton(AF_INET, \"1.1.1.1\", &addr));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_addr(rr, ARES_RR_A_ADDR, &addr));\n  /* AAAA */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ANSWER, \"example.com\",\n      ARES_REC_TYPE_AAAA, ARES_CLASS_IN, 300));\n  EXPECT_LT(0, ares_inet_pton(AF_INET6, \"2600::4\", &addr6));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_addr6(rr, ARES_RR_AAAA_ADDR, &addr6));\n  /* MX */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ANSWER, \"example.com\",\n      ARES_REC_TYPE_MX, ARES_CLASS_IN, 3600));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_MX_PREFERENCE, 10));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_MX_EXCHANGE, \"mail.example.com\"));\n  /* CNAME */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ANSWER, \"example.com\",\n      ARES_REC_TYPE_CNAME, ARES_CLASS_IN, 3600));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_CNAME_CNAME, \"b.example.com\"));\n  /* TXT */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ANSWER, \"example.com\",\n      ARES_REC_TYPE_TXT, ARES_CLASS_IN, 3600));\n  const char txt1[] = \"blah=here blah=there anywhere\";\n  const char txt2[] = \"some other record\";\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_add_abin(rr, ARES_RR_TXT_DATA, (unsigned char *)txt1,\n      sizeof(txt1)-1));\n   EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_add_abin(rr, ARES_RR_TXT_DATA, (unsigned char *)txt2,\n      sizeof(txt2)-1));\n  /* SIG */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ANSWER, \"example.com\",\n      ARES_REC_TYPE_SIG, ARES_CLASS_ANY, 0));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_SIG_TYPE_COVERED, ARES_REC_TYPE_TXT));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u8(rr, ARES_RR_SIG_ALGORITHM, 1));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u8(rr, ARES_RR_SIG_LABELS, 1));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u32(rr, ARES_RR_SIG_ORIGINAL_TTL, 3200));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u32(rr, ARES_RR_SIG_EXPIRATION, (unsigned int)time(NULL)));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u32(rr, ARES_RR_SIG_INCEPTION, (unsigned int)time(NULL) - (86400 * 365)));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_SIG_KEY_TAG, 0x1234));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_SIG_SIGNERS_NAME, \"signer.example.com\"));\n  const unsigned char sig[] = {\n    0xd2, 0xab, 0xde, 0x24, 0x0d, 0x7c, 0xd3, 0xee, 0x6b, 0x4b, 0x28, 0xc5,\n    0x4d, 0xf0, 0x34, 0xb9, 0x79, 0x83, 0xa1, 0xd1, 0x6e, 0x8a, 0x41, 0x0e,\n    0x45, 0x61, 0xcb, 0x10, 0x66, 0x18, 0xe9, 0x71 };\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_bin(rr, ARES_RR_SIG_SIGNATURE, sig, sizeof(sig)));\n\n\n  /* == Authority == */\n  /* NS */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_AUTHORITY, \"example.com\",\n      ARES_REC_TYPE_NS, ARES_CLASS_IN, 38400));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_NS_NSDNAME, \"ns1.example.com\"));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_AUTHORITY, \"example.com\",\n      ARES_REC_TYPE_NS, ARES_CLASS_IN, 38400));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_NS_NSDNAME, \"ns2.example.com\"));\n  /* SOA */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_AUTHORITY, \"example.com\",\n      ARES_REC_TYPE_SOA, ARES_CLASS_IN, 86400));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_SOA_MNAME, \"ns1.example.com\"));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_SOA_RNAME, \"tech\\\\.support.example.com\"));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u32(rr, ARES_RR_SOA_SERIAL, 2023110701));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u32(rr, ARES_RR_SOA_REFRESH, 28800));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u32(rr, ARES_RR_SOA_RETRY, 7200));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u32(rr, ARES_RR_SOA_EXPIRE, 604800));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u32(rr, ARES_RR_SOA_MINIMUM, 86400));\n\n  /* == Additional */\n  /* OPT */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL, \"\",\n      ARES_REC_TYPE_OPT, ARES_CLASS_IN, 0));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_OPT_UDP_SIZE, 1280));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u8(rr, ARES_RR_OPT_VERSION, 0));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_OPT_FLAGS, 0));\n  unsigned char optval[] = { 'c', '-', 'a', 'r', 'e', 's' };\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_opt(rr, ARES_RR_OPT_OPTIONS, 3 /* NSID */, optval, sizeof(optval)));\n  /* PTR -- doesn't make sense, but ok */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL, \"example.com\",\n      ARES_REC_TYPE_PTR, ARES_CLASS_IN, 300));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_PTR_DNAME, \"b.example.com\"));\n  /* HINFO */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL, \"example.com\",\n      ARES_REC_TYPE_HINFO, ARES_CLASS_IN, 300));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_HINFO_CPU, \"Virtual\"));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_HINFO_OS, \"Linux\"));\n  /* SRV */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL,\n      \"_ldap.example.com\", ARES_REC_TYPE_SRV, ARES_CLASS_IN, 300));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_SRV_PRIORITY, 100));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_SRV_WEIGHT, 1));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_SRV_PORT, 389));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_SRV_TARGET, \"ldap.example.com\"));\n  /* TLSA */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL,\n      \"_443._tcp.example.com\", ARES_REC_TYPE_TLSA, ARES_CLASS_IN, 86400));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u8(rr, ARES_RR_TLSA_CERT_USAGE, ARES_TLSA_USAGE_CA));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u8(rr, ARES_RR_TLSA_SELECTOR, ARES_TLSA_SELECTOR_FULL));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u8(rr, ARES_RR_TLSA_MATCH, ARES_TLSA_MATCH_SHA256));\n  const unsigned char tlsa[] = {\n    0xd2, 0xab, 0xde, 0x24, 0x0d, 0x7c, 0xd3, 0xee, 0x6b, 0x4b, 0x28, 0xc5,\n    0x4d, 0xf0, 0x34, 0xb9, 0x79, 0x83, 0xa1, 0xd1, 0x6e, 0x8a, 0x41, 0x0e,\n    0x45, 0x61, 0xcb, 0x10, 0x66, 0x18, 0xe9, 0x71 };\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_bin(rr, ARES_RR_TLSA_DATA, tlsa, sizeof(tlsa)));\n  /* SVCB */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL,\n      \"_1234._bar.example.com\", ARES_REC_TYPE_SVCB, ARES_CLASS_IN, 300));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_SVCB_PRIORITY, 1));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_SVCB_TARGET, \"svc1.example.net\"));\n  /* IPV6 hint is a list of IPV6 addresses in network byte order, concatenated */\n  struct ares_addr svcb_addr;\n  svcb_addr.family = AF_UNSPEC;\n  size_t               svcb_ipv6hint_len = 0;\n  const unsigned char *svcb_ipv6hint = (const unsigned char *)ares_dns_pton(\"2001:db8::1\", &svcb_addr, &svcb_ipv6hint_len);\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_opt(rr, ARES_RR_SVCB_PARAMS, ARES_SVCB_PARAM_IPV6HINT,\n      svcb_ipv6hint, svcb_ipv6hint_len));\n  /* Port is 16bit big endian format */\n  unsigned short svcb_port = htons(1234);\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_opt(rr, ARES_RR_SVCB_PARAMS, ARES_SVCB_PARAM_PORT,\n      (const unsigned char *)&svcb_port, sizeof(svcb_port)));\n  /* HTTPS */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL,\n      \"example.com\", ARES_REC_TYPE_HTTPS, ARES_CLASS_IN, 300));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_HTTPS_PRIORITY, 1));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_HTTPS_TARGET, \"\"));\n\n  /* In DNS string format which is 1 octet length indicator followed by string */\n  const unsigned char https_alpn[] = { 0x02, 'h', '3' };\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_opt(rr, ARES_RR_HTTPS_PARAMS, ARES_SVCB_PARAM_ALPN,\n      https_alpn, sizeof(https_alpn)));\n  /* URI */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL,\n      \"_ftp._tcp.example.com\", ARES_REC_TYPE_URI, ARES_CLASS_IN, 3600));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_URI_PRIORITY, 10));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_URI_WEIGHT, 1));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_URI_TARGET, \"ftp://ftp.example.com/public\"));\n  /* CAA */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL,\n      \"example.com\", ARES_REC_TYPE_CAA, ARES_CLASS_IN, 86400));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u8(rr, ARES_RR_CAA_CRITICAL, 0));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_CAA_TAG, \"issue\"));\n  unsigned char caa[] = \"letsencrypt.org\";\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_bin(rr, ARES_RR_CAA_VALUE, caa, sizeof(caa)));\n  /* NAPTR */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL,\n      \"example.com\", ARES_REC_TYPE_NAPTR, ARES_CLASS_IN, 86400));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_NAPTR_ORDER, 100));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_NAPTR_PREFERENCE, 10));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_NAPTR_FLAGS, \"S\"));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_NAPTR_SERVICES, \"SIP+D2U\"));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_NAPTR_REGEXP,\n      \"!^.*$!sip:customer-service@example.com!\"));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_NAPTR_REPLACEMENT,\n      \"_sip._udp.example.com.\"));\n  /* RAW_RR */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL, \"\",\n      ARES_REC_TYPE_RAW_RR, ARES_CLASS_IN, 0));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u16(rr, ARES_RR_RAW_RR_TYPE, 65432));\n  unsigned char data[] = { 0x00 };\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_bin(rr, ARES_RR_RAW_RR_DATA, data, sizeof(data)));\n\n  qdcount = ares_dns_record_query_cnt(dnsrec);\n  ancount = ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_ANSWER);\n  nscount = ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_AUTHORITY);\n  arcount = ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_ADDITIONAL);\n\n  /* Write */\n  EXPECT_EQ(ARES_SUCCESS, ares_dns_write(dnsrec, &msg, &msglen));\n\n  ares_buf_t *hexdump = ares_buf_create();\n  EXPECT_EQ(ARES_SUCCESS, ares_buf_hexdump(hexdump, msg, msglen));\n  char *hexdata = ares_buf_finish_str(hexdump, NULL);\n  //printf(\"HEXDUMP\\n%s\", hexdata);\n  ares_free(hexdata);\n\n  ares_dns_record_destroy(dnsrec); dnsrec = NULL;\n\n  /* Parse */\n  EXPECT_EQ(ARES_SUCCESS, ares_dns_parse(msg, msglen, 0, &dnsrec));\n  ares_free_string(msg); msg = NULL;\n\n  /* Re-write */\n  EXPECT_EQ(ARES_SUCCESS, ares_dns_write(dnsrec, &msg, &msglen));\n\n  EXPECT_EQ(qdcount, ares_dns_record_query_cnt(dnsrec));\n  EXPECT_EQ(ancount, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_ANSWER));\n  EXPECT_EQ(nscount, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_AUTHORITY));\n  EXPECT_EQ(arcount, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_ADDITIONAL));\n\n  /* Iterate and print */\n  ares_buf_t *printmsg = ares_buf_create();\n  ares_buf_append_str(printmsg, \";; ->>HEADER<<- opcode: \");\n  ares_buf_append_str(printmsg, ares_dns_opcode_tostr(ares_dns_record_get_opcode(dnsrec)));\n  ares_buf_append_str(printmsg, \", status: \");\n  ares_buf_append_str(printmsg, ares_dns_rcode_tostr(ares_dns_record_get_rcode(dnsrec)));\n  ares_buf_append_str(printmsg, \", id: \");\n  ares_buf_append_num_dec(printmsg, (size_t)ares_dns_record_get_id(dnsrec), 0);\n  ares_buf_append_str(printmsg, \"\\n;; flags: \");\n  ares_buf_append_num_hex(printmsg, (size_t)ares_dns_record_get_flags(dnsrec), 0);\n  ares_buf_append_str(printmsg, \"; QUERY: \");\n  ares_buf_append_num_dec(printmsg, ares_dns_record_query_cnt(dnsrec), 0);\n  ares_buf_append_str(printmsg, \", ANSWER: \");\n  ares_buf_append_num_dec(printmsg, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_ANSWER), 0);\n  ares_buf_append_str(printmsg, \", AUTHORITY: \");\n  ares_buf_append_num_dec(printmsg, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_AUTHORITY), 0);\n  ares_buf_append_str(printmsg, \", ADDITIONAL: \");\n  ares_buf_append_num_dec(printmsg, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_ADDITIONAL), 0);\n  ares_buf_append_str(printmsg, \"\\n\\n\");\n  ares_buf_append_str(printmsg, \";; QUESTION SECTION:\\n\");\n  for (size_t i = 0; i < ares_dns_record_query_cnt(dnsrec); i++) {\n    const char         *name;\n    ares_dns_rec_type_t qtype;\n    ares_dns_class_t    qclass;\n    ares_dns_record_query_get(dnsrec, i, &name, &qtype, &qclass);\n    ares_buf_append_str(printmsg, \";\");\n    ares_buf_append_str(printmsg, name);\n    ares_buf_append_str(printmsg, \".\\t\\t\\t\");\n    ares_buf_append_str(printmsg, ares_dns_class_tostr(qclass));\n    ares_buf_append_str(printmsg, \"\\t\");\n    ares_buf_append_str(printmsg, ares_dns_rec_type_tostr(qtype));\n    ares_buf_append_str(printmsg, \"\\n\");\n  }\n  ares_buf_append_str(printmsg, \"\\n\");\n  for (size_t i = ARES_SECTION_ANSWER; i < ARES_SECTION_ADDITIONAL + 1; i++) {\n    ares_buf_append_str(printmsg, \";; \");\n    ares_buf_append_str(printmsg, ares_dns_section_tostr((ares_dns_section_t)i));\n    ares_buf_append_str(printmsg, \" SECTION:\\n\");\n    for (size_t j = 0; j < ares_dns_record_rr_cnt(dnsrec, (ares_dns_section_t)i); j++) {\n      rr = ares_dns_record_rr_get(dnsrec, (ares_dns_section_t)i, j);\n      ares_buf_append_str(printmsg, ares_dns_rr_get_name(rr));\n      ares_buf_append_str(printmsg, \".\\t\\t\\t\");\n      ares_buf_append_str(printmsg, ares_dns_class_tostr(ares_dns_rr_get_class(rr)));\n      ares_buf_append_str(printmsg, \"\\t\");\n      ares_buf_append_str(printmsg, ares_dns_rec_type_tostr(ares_dns_rr_get_type(rr)));\n      ares_buf_append_str(printmsg, \"\\t\");\n      ares_buf_append_num_dec(printmsg, ares_dns_rr_get_ttl(rr), 0);\n      ares_buf_append_str(printmsg, \"\\t\");\n\n      size_t keys_cnt;\n      const ares_dns_rr_key_t *keys = ares_dns_rr_get_keys(ares_dns_rr_get_type(rr), &keys_cnt);\n      for (size_t k = 0; k<keys_cnt; k++) {\n        char buf[256] = \"\";\n        ares_buf_append_str(printmsg, ares_dns_rr_key_tostr(keys[k]));\n        ares_buf_append_str(printmsg, \"=\");\n        switch (ares_dns_rr_key_datatype(keys[k])) {\n          case ARES_DATATYPE_INADDR:\n            ares_inet_ntop(AF_INET, ares_dns_rr_get_addr(rr, keys[k]), buf, sizeof(buf));\n            ares_buf_append_str(printmsg, buf);\n            break;\n          case ARES_DATATYPE_INADDR6:\n            ares_inet_ntop(AF_INET6, ares_dns_rr_get_addr6(rr, keys[k]), buf, sizeof(buf));\n            ares_buf_append_str(printmsg, buf);\n            break;\n          case ARES_DATATYPE_U8:\n            ares_buf_append_num_dec(printmsg, ares_dns_rr_get_u8(rr, keys[k]), 0);\n            break;\n          case ARES_DATATYPE_U16:\n            ares_buf_append_num_dec(printmsg, ares_dns_rr_get_u16(rr, keys[k]), 0);\n            break;\n          case ARES_DATATYPE_U32:\n            ares_buf_append_num_dec(printmsg, ares_dns_rr_get_u32(rr, keys[k]), 0);\n            break;\n          case ARES_DATATYPE_NAME:\n          case ARES_DATATYPE_STR:\n            ares_buf_append_byte(printmsg, '\"');\n            ares_buf_append_str(printmsg, ares_dns_rr_get_str(rr, keys[k]));\n            ares_buf_append_byte(printmsg, '\"');\n            break;\n          case ARES_DATATYPE_BIN:\n            /* TODO */\n            break;\n          case ARES_DATATYPE_BINP:\n            {\n              ares_buf_append_byte(printmsg, '\"');\n              size_t templen;\n              ares_buf_append_str(printmsg, (const char *)ares_dns_rr_get_bin(rr, keys[k], &templen));\n              ares_buf_append_byte(printmsg, '\"');\n            }\n            break;\n          case ARES_DATATYPE_ABINP:\n            for (size_t a=0; a<ares_dns_rr_get_abin_cnt(rr, keys[k]); a++) {\n              if (a != 0) {\n                ares_buf_append_byte(printmsg, ' ');\n              }\n              ares_buf_append_byte(printmsg, '\"');\n              size_t templen;\n              ares_buf_append_str(printmsg, (const char *)ares_dns_rr_get_abin(rr, keys[k], a, &templen));\n              ares_buf_append_byte(printmsg, '\"');\n            }\n            break;\n          case ARES_DATATYPE_OPT:\n            /* TODO */\n            break;\n        }\n        ares_buf_append_str(printmsg, \" \");\n      }\n      ares_buf_append_str(printmsg, \"\\n\");\n    }\n  }\n  ares_buf_append_str(printmsg, \";; SIZE: \");\n  ares_buf_append_num_dec(printmsg, msglen, 0);\n  ares_buf_append_str(printmsg, \"\\n\\n\");\n\n  char *printdata = ares_buf_finish_str(printmsg, NULL);\n  //printf(\"%s\", printdata);\n  ares_free(printdata);\n\n  ares_dns_record_destroy(dnsrec);\n  ares_free_string(msg);\n\n  // Invalid\n  EXPECT_NE(ARES_SUCCESS, ares_dns_parse(NULL, 0, 0, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_dns_record_create(NULL, 0, 0, ARES_OPCODE_QUERY, ARES_RCODE_NOERROR));\n  EXPECT_EQ(0, ares_dns_record_get_id(NULL));\n  EXPECT_EQ(0, ares_dns_record_get_flags(NULL));\n  EXPECT_EQ(0, (int)ares_dns_record_get_opcode(NULL));\n  EXPECT_EQ(0, (int)ares_dns_record_get_rcode(NULL));\n  EXPECT_EQ(0, (int)ares_dns_record_query_cnt(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_dns_record_query_set_name(NULL, 0, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_dns_record_query_set_type(NULL, 0, ARES_REC_TYPE_A));\n  EXPECT_NE(ARES_SUCCESS, ares_dns_record_query_get(NULL, 0, NULL, NULL, NULL));\n  EXPECT_EQ(0, ares_dns_record_rr_cnt(NULL, ARES_SECTION_ANSWER));\n  EXPECT_NE(ARES_SUCCESS, ares_dns_record_rr_add(NULL, NULL, ARES_SECTION_ANSWER, NULL, ARES_REC_TYPE_A, ARES_CLASS_IN, 0));\n  EXPECT_NE(ARES_SUCCESS, ares_dns_record_rr_del(NULL, ARES_SECTION_ANSWER, 0));\n  EXPECT_EQ(nullptr, ares_dns_record_rr_get(NULL, ARES_SECTION_ANSWER, 0));\n  EXPECT_EQ(nullptr, ares_dns_rr_get_name(NULL));\n  EXPECT_EQ(0, (int)ares_dns_rr_get_type(NULL));\n  EXPECT_EQ(0, (int)ares_dns_rr_get_class(NULL));\n  EXPECT_EQ(0, ares_dns_rr_get_ttl(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_dns_write(NULL, NULL, NULL));\n#ifndef CARES_SYMBOL_HIDING\n  ares_dns_record_ttl_decrement(NULL, 0);\n#endif\n  EXPECT_EQ(nullptr, ares_dns_rr_get_addr(NULL, ARES_RR_A_ADDR));\n  EXPECT_EQ(nullptr, ares_dns_rr_get_addr(NULL, ARES_RR_NS_NSDNAME));\n  EXPECT_EQ(nullptr, ares_dns_rr_get_addr6(NULL, ARES_RR_AAAA_ADDR));\n  EXPECT_EQ(nullptr, ares_dns_rr_get_addr6(NULL, ARES_RR_NS_NSDNAME));\n  EXPECT_EQ(0, ares_dns_rr_get_u8(NULL, ARES_RR_SIG_ALGORITHM));\n  EXPECT_EQ(0, ares_dns_rr_get_u8(NULL, ARES_RR_NS_NSDNAME));\n  EXPECT_EQ(0, ares_dns_rr_get_u16(NULL, ARES_RR_MX_PREFERENCE));\n  EXPECT_EQ(0, ares_dns_rr_get_u16(NULL, ARES_RR_NS_NSDNAME));\n  EXPECT_EQ(0, ares_dns_rr_get_u32(NULL, ARES_RR_SOA_SERIAL));\n  EXPECT_EQ(0, ares_dns_rr_get_u32(NULL, ARES_RR_NS_NSDNAME));\n  EXPECT_EQ(nullptr, ares_dns_rr_get_bin(NULL, ARES_RR_TXT_DATA, NULL));\n  EXPECT_EQ(nullptr, ares_dns_rr_get_bin(NULL, ARES_RR_NS_NSDNAME, NULL));\n  EXPECT_EQ(nullptr, ares_dns_rr_get_str(NULL, ARES_RR_NS_NSDNAME));\n  EXPECT_EQ(nullptr, ares_dns_rr_get_str(NULL, ARES_RR_MX_PREFERENCE));\n  EXPECT_EQ(0, ares_dns_rr_get_opt_cnt(NULL, ARES_RR_OPT_OPTIONS));\n  EXPECT_EQ(0, ares_dns_rr_get_opt_cnt(NULL, ARES_RR_A_ADDR));\n  EXPECT_EQ(65535, ares_dns_rr_get_opt(NULL, ARES_RR_OPT_OPTIONS, 0, NULL, NULL));\n  EXPECT_EQ(65535, ares_dns_rr_get_opt(NULL, ARES_RR_A_ADDR, 0, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_dns_rr_get_opt_byid(NULL, ARES_RR_OPT_OPTIONS, 1, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_dns_rr_get_opt_byid(NULL, ARES_RR_A_ADDR, 1, NULL, NULL));\n}",
      "fn_code_pos": [
        [
          644,
          0
        ],
        [
          1099,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, DNSParseFlags) {\n  ares_dns_record_t   *dnsrec = NULL;\n  ares_dns_rr_t       *rr     = NULL;\n  struct in_addr       addr;\n  unsigned char       *msg    = NULL;\n  size_t               msglen = 0;\n\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_create(&dnsrec, 0x1234,\n      ARES_FLAG_QR|ARES_FLAG_AA|ARES_FLAG_RD|ARES_FLAG_RA,\n      ARES_OPCODE_QUERY, ARES_RCODE_NOERROR));\n\n  /* == Question == */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_query_add(dnsrec, \"example.com\",\n      ARES_REC_TYPE_ANY,\n      ARES_CLASS_IN));\n\n  /* == Answer == */\n  /* A */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ANSWER, \"example.com\",\n      ARES_REC_TYPE_A, ARES_CLASS_IN, 300));\n  EXPECT_LT(0, ares_inet_pton(AF_INET, \"1.1.1.1\", &addr));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_addr(rr, ARES_RR_A_ADDR, &addr));\n  /* TLSA */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ANSWER,\n      \"_443._tcp.example.com\", ARES_REC_TYPE_TLSA, ARES_CLASS_IN, 86400));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u8(rr, ARES_RR_TLSA_CERT_USAGE, ARES_TLSA_USAGE_CA));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u8(rr, ARES_RR_TLSA_SELECTOR, ARES_TLSA_SELECTOR_FULL));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_u8(rr, ARES_RR_TLSA_MATCH, ARES_TLSA_MATCH_SHA256));\n  const unsigned char tlsa[] = {\n    0xd2, 0xab, 0xde, 0x24, 0x0d, 0x7c, 0xd3, 0xee, 0x6b, 0x4b, 0x28, 0xc5,\n    0x4d, 0xf0, 0x34, 0xb9, 0x79, 0x83, 0xa1, 0xd1, 0x6e, 0x8a, 0x41, 0x0e,\n    0x45, 0x61, 0xcb, 0x10, 0x66, 0x18, 0xe9, 0x71 };\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_bin(rr, ARES_RR_TLSA_DATA, tlsa, sizeof(tlsa)));\n\n  /* == Authority == */\n  /* NS */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_AUTHORITY, \"example.com\",\n      ARES_REC_TYPE_NS, ARES_CLASS_IN, 38400));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_NS_NSDNAME, \"ns1.example.com\"));\n\n  /* == Additional */\n  /* PTR -- doesn't make sense, but ok */\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_record_rr_add(&rr, dnsrec, ARES_SECTION_ADDITIONAL, \"example.com\",\n      ARES_REC_TYPE_PTR, ARES_CLASS_IN, 300));\n  EXPECT_EQ(ARES_SUCCESS,\n    ares_dns_rr_set_str(rr, ARES_RR_PTR_DNAME, \"b.example.com\"));\n\n  /* Write */\n  EXPECT_EQ(ARES_SUCCESS, ares_dns_write(dnsrec, &msg, &msglen));\n\n  /* Cleanup - before reuse */\n  ares_dns_record_destroy(dnsrec);\n\n  /* Parse \"base\" type records (1035) */\n  EXPECT_EQ(ARES_SUCCESS, ares_dns_parse(msg, msglen, ARES_DNS_PARSE_AN_BASE_RAW |\n    ARES_DNS_PARSE_NS_BASE_RAW | ARES_DNS_PARSE_AR_BASE_RAW, &dnsrec));\n\n  EXPECT_EQ(1, ares_dns_record_query_cnt(dnsrec));\n  EXPECT_EQ(2, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_ANSWER));\n  EXPECT_EQ(1, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_AUTHORITY));\n  EXPECT_EQ(1, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_ADDITIONAL));\n\n  rr = ares_dns_record_rr_get(dnsrec, ARES_SECTION_ANSWER, 0);\n  EXPECT_EQ(ARES_REC_TYPE_RAW_RR, ares_dns_rr_get_type(rr));\n\n  rr = ares_dns_record_rr_get(dnsrec, ARES_SECTION_ANSWER, 1);\n  EXPECT_EQ(ARES_REC_TYPE_TLSA, ares_dns_rr_get_type(rr));\n\n  rr = ares_dns_record_rr_get(dnsrec, ARES_SECTION_AUTHORITY, 0);\n  EXPECT_EQ(ARES_REC_TYPE_RAW_RR, ares_dns_rr_get_type(rr));\n\n  rr = ares_dns_record_rr_get(dnsrec, ARES_SECTION_ADDITIONAL, 0);\n  EXPECT_EQ(ARES_REC_TYPE_RAW_RR, ares_dns_rr_get_type(rr));\n\n  /* Cleanup - before reuse */\n\n  ares_dns_record_destroy(dnsrec);\n\n  /* Parse later RFCs (no name compression) type records */\n\n  EXPECT_EQ(ARES_SUCCESS, ares_dns_parse(msg, msglen, ARES_DNS_PARSE_AN_EXT_RAW |\n    ARES_DNS_PARSE_NS_EXT_RAW | ARES_DNS_PARSE_AR_EXT_RAW, &dnsrec));\n\n  EXPECT_EQ(1, ares_dns_record_query_cnt(dnsrec));\n  EXPECT_EQ(2, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_ANSWER));\n  EXPECT_EQ(1, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_AUTHORITY));\n  EXPECT_EQ(1, ares_dns_record_rr_cnt(dnsrec, ARES_SECTION_ADDITIONAL));\n\n  rr = ares_dns_record_rr_get(dnsrec, ARES_SECTION_ANSWER, 0);\n  EXPECT_EQ(ARES_REC_TYPE_A, ares_dns_rr_get_type(rr));\n\n  rr = ares_dns_record_rr_get(dnsrec, ARES_SECTION_ANSWER, 1);\n  EXPECT_EQ(ARES_REC_TYPE_RAW_RR, ares_dns_rr_get_type(rr));\n\n  rr = ares_dns_record_rr_get(dnsrec, ARES_SECTION_AUTHORITY, 0);\n  EXPECT_EQ(ARES_REC_TYPE_NS, ares_dns_rr_get_type(rr));\n\n  rr = ares_dns_record_rr_get(dnsrec, ARES_SECTION_ADDITIONAL, 0);\n  EXPECT_EQ(ARES_REC_TYPE_PTR, ares_dns_rr_get_type(rr));\n\n  ares_dns_record_destroy(dnsrec);\n  ares_free_string(msg); msg = NULL;\n}",
      "fn_code_pos": [
        [
          1101,
          0
        ],
        [
          1215,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, ArrayMisuse) {\n  EXPECT_EQ(NULL, ares_array_create(0, NULL));\n  ares_array_destroy(NULL);\n  EXPECT_EQ(NULL, ares_array_finish(NULL, NULL));\n  EXPECT_EQ(0, ares_array_len(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_array_insert_at(NULL, NULL, 0));\n  EXPECT_NE(ARES_SUCCESS, ares_array_insertdata_at(NULL, 0, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_array_insert_last(NULL, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_array_insertdata_last(NULL, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_array_insert_first(NULL, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_array_insertdata_first(NULL, NULL));\n  EXPECT_EQ(NULL, ares_array_at(NULL, 0));\n  EXPECT_EQ(NULL, ares_array_first(NULL));\n  EXPECT_EQ(NULL, ares_array_last(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_array_claim_at(NULL, 0, NULL, 0));\n  EXPECT_NE(ARES_SUCCESS, ares_array_remove_at(NULL, 0));\n  EXPECT_NE(ARES_SUCCESS, ares_array_remove_first(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_array_remove_last(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_array_sort(NULL, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_array_set_size(NULL, 0));\n}",
      "fn_code_pos": [
        [
          1217,
          0
        ],
        [
          1237,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, BufMisuse) {\n  EXPECT_EQ(NULL, ares_buf_create_const(NULL, 0));\n  ares_buf_reclaim(NULL);\n  EXPECT_NE(ARES_SUCCESS, ares_buf_append(NULL, NULL, 55));\n  size_t len = 10;\n  EXPECT_EQ(NULL, ares_buf_append_start(NULL, &len));\n  EXPECT_EQ(NULL, ares_buf_append_start(NULL, NULL));\n  ares_buf_append_finish(NULL, 0);\n  EXPECT_EQ(NULL, ares_buf_finish_bin(NULL, NULL));\n  EXPECT_EQ(NULL, ares_buf_finish_str(NULL, NULL));\n  ares_buf_tag(NULL);\n  EXPECT_NE(ARES_SUCCESS, ares_buf_tag_rollback(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_buf_tag_clear(NULL));\n  EXPECT_EQ(NULL, ares_buf_tag_fetch(NULL, NULL));\n  EXPECT_EQ((size_t)0, ares_buf_tag_length(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_buf_tag_fetch_bytes(NULL, NULL, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_buf_tag_fetch_string(NULL, NULL, 0));\n  EXPECT_NE(ARES_SUCCESS, ares_buf_fetch_bytes_dup(NULL, 0, ARES_FALSE, NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_buf_fetch_str_dup(NULL, 0, NULL));\n  EXPECT_EQ((size_t)0, ares_buf_consume_whitespace(NULL, ARES_FALSE));\n  EXPECT_EQ((size_t)0, ares_buf_consume_nonwhitespace(NULL));\n  EXPECT_EQ((size_t)0, ares_buf_consume_line(NULL, ARES_FALSE));\n  EXPECT_EQ(ARES_FALSE, ares_buf_begins_with(NULL, NULL, 0));\n  EXPECT_EQ((size_t)0, ares_buf_get_position(NULL));\n  EXPECT_NE(ARES_SUCCESS, ares_buf_set_position(NULL, 0));\n  EXPECT_NE(ARES_SUCCESS, ares_buf_parse_dns_binstr(NULL, 0, NULL, NULL));\n}",
      "fn_code_pos": [
        [
          1239,
          0
        ],
        [
          1265,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableAsvpMisuse) {\n  EXPECT_EQ(ARES_FALSE, ares_htable_asvp_insert(NULL, ARES_SOCKET_BAD, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_asvp_get(NULL, ARES_SOCKET_BAD, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_asvp_remove(NULL, ARES_SOCKET_BAD));\n  EXPECT_EQ((size_t)0, ares_htable_asvp_num_keys(NULL));\n}",
      "fn_code_pos": [
        [
          1267,
          0
        ],
        [
          1272,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableStrvpMisuse) {\n  EXPECT_EQ(ARES_FALSE, ares_htable_strvp_insert(NULL, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_strvp_get(NULL, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_strvp_remove(NULL, NULL));\n  EXPECT_EQ((size_t)0, ares_htable_strvp_num_keys(NULL));\n}",
      "fn_code_pos": [
        [
          1274,
          0
        ],
        [
          1279,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableVpStrMisuse) {\n  EXPECT_EQ(ARES_FALSE, ares_htable_vpstr_insert(NULL, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_vpstr_get(NULL, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_vpstr_remove(NULL, NULL));\n  EXPECT_EQ((size_t)0, ares_htable_vpstr_num_keys(NULL));\n}",
      "fn_code_pos": [
        [
          1281,
          0
        ],
        [
          1286,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableDictMisuse) {\n  EXPECT_EQ(ARES_FALSE, ares_htable_dict_insert(NULL, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_dict_get(NULL, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_dict_remove(NULL, NULL));\n  EXPECT_EQ((size_t)0, ares_htable_dict_num_keys(NULL));\n}",
      "fn_code_pos": [
        [
          1288,
          0
        ],
        [
          1293,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableSzvpMisuse) {\n  EXPECT_EQ(ARES_FALSE, ares_htable_szvp_insert(NULL, 0, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_szvp_get(NULL, 0, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_szvp_remove(NULL, 0));\n  EXPECT_EQ((size_t)0, ares_htable_szvp_num_keys(NULL));\n}",
      "fn_code_pos": [
        [
          1295,
          0
        ],
        [
          1300,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableVpvpMisuse) {\n  EXPECT_EQ(ARES_FALSE, ares_htable_vpvp_insert(NULL, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_vpvp_get(NULL, NULL, NULL));\n  EXPECT_EQ(ARES_FALSE, ares_htable_vpvp_remove(NULL, NULL));\n  EXPECT_EQ((size_t)0, ares_htable_vpvp_num_keys(NULL));\n}",
      "fn_code_pos": [
        [
          1302,
          0
        ],
        [
          1307,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, LlistMisuse) {\n  ares_llist_replace_destructor(NULL, NULL);\n  EXPECT_EQ(NULL, ares_llist_insert_before(NULL, NULL));\n  EXPECT_EQ(NULL, ares_llist_insert_after(NULL, NULL));\n  EXPECT_EQ(NULL, ares_llist_node_last(NULL));\n  EXPECT_EQ(NULL, ares_llist_node_next(NULL));\n  EXPECT_EQ(NULL, ares_llist_node_prev(NULL));\n  EXPECT_EQ((size_t)0, ares_llist_len(NULL));\n  EXPECT_EQ(NULL, ares_llist_node_parent(NULL));\n  EXPECT_EQ(NULL, ares_llist_node_claim(NULL));\n  ares_llist_node_replace(NULL, NULL);\n}",
      "fn_code_pos": [
        [
          1309,
          0
        ],
        [
          1320,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "static void array_member_init(void *mb, unsigned int id)\n{\n  array_member_t *m = (array_member_t *)mb;\n  m->id             = id;\n  m->buf            = ares_buf_create();\n  ares_buf_append_be32(m->buf, id);\n}",
      "fn_code_pos": [
        [
          1327,
          0
        ],
        [
          1333,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "array_member_init",
        "parameters": {
          "mb": "void",
          "id": "unsigned int"
        },
        "return_type": "void"
      }
    },
    {
      "fn_code": "static void array_member_destroy(void *mb)\n{\n  array_member_t *m = (array_member_t *)mb;\n  ares_buf_destroy(m->buf);\n}",
      "fn_code_pos": [
        [
          1335,
          0
        ],
        [
          1339,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "array_member_destroy",
        "parameters": {
          "mb": "void"
        },
        "return_type": "void"
      }
    },
    {
      "fn_code": "static int array_sort_cmp(const void *data1, const void *data2)\n{\n  const array_member_t *m1 = (const array_member_t *)data1;\n  const array_member_t *m2 = (const array_member_t *)data2;\n  if (m1->id > m2->id)\n    return 1;\n  if (m1->id < m2->id)\n    return -1;\n  return 0;\n}",
      "fn_code_pos": [
        [
          1341,
          0
        ],
        [
          1350,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "array_sort_cmp",
        "parameters": {
          "data1": "void",
          "data2": "void"
        },
        "return_type": "int"
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, Array) {\n  ares_array_t   *a       = NULL;\n  array_member_t *m       = NULL;\n  array_member_t  mbuf;\n  unsigned int    cnt     = 0;\n  unsigned int    removed = 0;\n  void           *ptr     = NULL;\n  size_t          i;\n\n  a = ares_array_create(sizeof(array_member_t), array_member_destroy);\n  EXPECT_NE(nullptr, a);\n\n  /* Try to sort with no elements, should break out */\n  EXPECT_EQ(ARES_SUCCESS, ares_array_sort(a, array_sort_cmp));\n\n  /* Add 8 elements */\n  for ( ; cnt < 8 ; cnt++) {\n    EXPECT_EQ(ARES_SUCCESS, ares_array_insert_last(&ptr, a));\n    array_member_init(ptr, cnt+1);\n  }\n\n  /* Insert at invalid index */\n  EXPECT_NE(ARES_SUCCESS, ares_array_insert_at(&ptr, a, 12345678));\n\n  /* Verify count */\n  EXPECT_EQ(cnt, ares_array_len(a));\n\n  /* Remove the first 2 elements */\n  EXPECT_EQ(ARES_SUCCESS, ares_array_remove_first(a));\n  EXPECT_EQ(ARES_SUCCESS, ares_array_remove_first(a));\n  removed += 2;\n\n  /* Verify count */\n  EXPECT_EQ(cnt-removed, ares_array_len(a));\n\n  /* Verify id of first element */\n  m = (array_member_t *)ares_array_first(a);\n  EXPECT_NE(nullptr, m);\n  EXPECT_EQ(3, m->id);\n\n\n  /* Add 100 total elements, this should force a shift of memory at some\n   * to make sure moves are working */\n  for ( ; cnt < 100 ; cnt++) {\n    EXPECT_EQ(ARES_SUCCESS, ares_array_insert_last(&ptr, a));\n    array_member_init(ptr, cnt+1);\n  }\n\n  /* Verify count */\n  EXPECT_EQ(cnt-removed, ares_array_len(a));\n\n  /* Remove 2 from the end */\n  EXPECT_EQ(ARES_SUCCESS, ares_array_remove_last(a));\n  EXPECT_EQ(ARES_SUCCESS, ares_array_remove_last(a));\n  removed += 2;\n\n  /* Verify count */\n  EXPECT_EQ(cnt-removed, ares_array_len(a));\n\n  /* Verify expected id of last member */\n  m = (array_member_t *)ares_array_last(a);\n  EXPECT_NE(nullptr, m);\n  EXPECT_EQ(cnt-2, m->id);\n\n  /* Remove 3 middle members */\n  EXPECT_EQ(ARES_SUCCESS, ares_array_remove_at(a, ares_array_len(a)/2));\n  EXPECT_EQ(ARES_SUCCESS, ares_array_remove_at(a, ares_array_len(a)/2));\n  EXPECT_EQ(ARES_SUCCESS, ares_array_remove_at(a, ares_array_len(a)/2));\n  removed += 3;\n\n  /* Verify count */\n  EXPECT_EQ(cnt-removed, ares_array_len(a));\n\n  /* Claim a middle member then re-add it at the same position */\n  i = ares_array_len(a) / 2;\n  EXPECT_EQ(ARES_SUCCESS, ares_array_claim_at(&mbuf, sizeof(mbuf), a, i));\n  EXPECT_EQ(ARES_SUCCESS, ares_array_insert_at(&ptr, a, i));\n  array_member_init(ptr, mbuf.id);\n  array_member_destroy((void *)&mbuf);\n  /* Verify count */\n  EXPECT_EQ(cnt-removed, ares_array_len(a));\n\n  /* Iterate across the array, make sure each entry is greater than the last and\n   * the data in the buffer matches the id in the array */\n  unsigned int last_id = 0;\n  for (i=0; i<ares_array_len(a); i++) {\n    m = (array_member_t *)ares_array_at(a, i);\n    EXPECT_NE(nullptr, m);\n    EXPECT_GT(m->id, last_id);\n    last_id = m->id;\n\n    unsigned int bufval = 0;\n    ares_buf_tag(m->buf);\n    EXPECT_EQ(ARES_SUCCESS, ares_buf_fetch_be32(m->buf, &bufval));\n    ares_buf_tag_rollback(m->buf);\n    EXPECT_EQ(bufval, m->id);\n  }\n\n  /* add a new element in the middle to the beginning with a high id */\n  EXPECT_EQ(ARES_SUCCESS, ares_array_insert_at(&ptr, a, ares_array_len(a)/2));\n  array_member_init(ptr, 100000);\n\n  /* Sort the array */\n  EXPECT_EQ(ARES_SUCCESS, ares_array_sort(a, array_sort_cmp));\n\n  /* Iterate across the array, make sure each entry is greater than the last and\n   * the data in the buffer matches the id in the array */\n  last_id = 0;\n  for (i=0; i<ares_array_len(a); i++) {\n    m = (array_member_t *)ares_array_at(a, i);\n    EXPECT_NE(nullptr, m);\n    EXPECT_GT(m->id, last_id);\n    last_id = m->id;\n\n    unsigned int bufval = 0;\n    ares_buf_tag(m->buf);\n    EXPECT_EQ(ARES_SUCCESS, ares_buf_fetch_be32(m->buf, &bufval));\n    ares_buf_tag_rollback(m->buf);\n    EXPECT_EQ(bufval, m->id);\n  }\n\n  ares_array_destroy(a);\n}",
      "fn_code_pos": [
        [
          1352,
          0
        ],
        [
          1474,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableVpvp) {\n  ares_llist_t       *l = NULL;\n  ares_htable_vpvp_t *h = NULL;\n  ares_llist_node_t  *n = NULL;\n  size_t               i;\n\n#define VPVP_TABLE_SIZE 1000\n\n  l = ares_llist_create(NULL);\n  EXPECT_NE((void *)NULL, l);\n\n  h = ares_htable_vpvp_create(NULL, ares_free);\n  EXPECT_NE((void *)NULL, h);\n\n  for (i=0; i<VPVP_TABLE_SIZE; i++) {\n    void *p = ares_malloc_zero(4);\n    EXPECT_NE((void *)NULL, p);\n    EXPECT_NE((void *)NULL, ares_llist_insert_last(l, p));\n    EXPECT_TRUE(ares_htable_vpvp_insert(h, p, p));\n  }\n\n  EXPECT_EQ(VPVP_TABLE_SIZE, ares_llist_len(l));\n  EXPECT_EQ(VPVP_TABLE_SIZE, ares_htable_vpvp_num_keys(h));\n\n  n = ares_llist_node_first(l);\n  EXPECT_NE((void *)NULL, n);\n  while (n != NULL) {\n    ares_llist_node_t *next = ares_llist_node_next(n);\n    void               *p    = ares_llist_node_val(n);\n    EXPECT_NE((void *)NULL, p);\n    EXPECT_EQ(p, ares_htable_vpvp_get_direct(h, p));\n    EXPECT_TRUE(ares_htable_vpvp_get(h, p, NULL));\n    EXPECT_TRUE(ares_htable_vpvp_remove(h, p));\n    ares_llist_node_destroy(n);\n    n = next;\n  }\n\n  EXPECT_EQ(0, ares_llist_len(l));\n  EXPECT_EQ(0, ares_htable_vpvp_num_keys(h));\n\n  ares_llist_destroy(l);\n  ares_htable_vpvp_destroy(h);\n}",
      "fn_code_pos": [
        [
          1476,
          0
        ],
        [
          1518,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, BufSplitStr) {\n  ares_buf_t  *buf   = NULL;\n  char        **strs  = NULL;\n  size_t        nstrs = 0;\n\n  buf = ares_buf_create();\n  ares_buf_append_str(buf, \"string1\\nstring2 string3\\t   \\nstring4\");\n  ares_buf_split_str(buf, (const unsigned char *)\"\\n \\t\", 2, ARES_BUF_SPLIT_TRIM, 0, &strs, &nstrs);\n  ares_buf_destroy(buf);\n\n  EXPECT_EQ(4, nstrs);\n  EXPECT_TRUE(ares_streq(strs[0], \"string1\"));\n  EXPECT_TRUE(ares_streq(strs[1], \"string2\"));\n  EXPECT_TRUE(ares_streq(strs[2], \"string3\"));\n  EXPECT_TRUE(ares_streq(strs[3], \"string4\"));\n  ares_free_array(strs, nstrs, ares_free);\n}",
      "fn_code_pos": [
        [
          1520,
          0
        ],
        [
          1536,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, BufReplace) {\n  ares_buf_t  *buf = NULL;\n  size_t       i;\n  struct {\n    const char *input;\n    const char *srch;\n    const char *rplc;\n    const char *output;\n  } tests[] = {\n    /* Same size */\n    { \"nameserver_1.2.3.4\\nnameserver_2.3.4.5\\n\", \"_\", \" \", \"nameserver 1.2.3.4\\nnameserver 2.3.4.5\\n\" },\n    /* Longer */\n    { \"nameserver_1.2.3.4\\nnameserver_2.3.4.5\\n\", \"_\", \"|||\", \"nameserver|||1.2.3.4\\nnameserver|||2.3.4.5\\n\" },\n    /* Shorter */\n    { \"nameserver_1.2.3.4\\nnameserver_2.3.4.5\\n\", \"_\", \"\", \"nameserver1.2.3.4\\nnameserver2.3.4.5\\n\" }\n  };\n  char        *str = NULL;\n\n  for (i=0; i<sizeof(tests)/sizeof(*tests); i++) {\n    buf = ares_buf_create();\n    EXPECT_EQ(ARES_SUCCESS, ares_buf_append_str(buf, tests[i].input));\n    EXPECT_EQ(ARES_SUCCESS, ares_buf_replace(buf, (const unsigned char *)tests[i].srch, ares_strlen(tests[i].srch), (const unsigned char *)tests[i].rplc, ares_strlen(tests[i].rplc)));\n    str = ares_buf_finish_str(buf, NULL);\n    EXPECT_STREQ(str, tests[i].output);\n    ares_free(str);\n  }\n}",
      "fn_code_pos": [
        [
          1538,
          0
        ],
        [
          1564,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableAsvp) {\n  ares_llist_t       *l = NULL;\n  ares_htable_asvp_t *h = NULL;\n  ares_llist_node_t  *n = NULL;\n  size_t               i;\n\n#define ASVP_TABLE_SIZE 1000\n\n  l = ares_llist_create(NULL);\n  EXPECT_NE((void *)NULL, l);\n\n  h = ares_htable_asvp_create(ares_free);\n  EXPECT_NE((void *)NULL, h);\n\n  for (i=0; i<ASVP_TABLE_SIZE; i++) {\n    test_htable_asvp_t *a = (test_htable_asvp_t *)ares_malloc_zero(sizeof(*a));\n    EXPECT_NE((void *)NULL, a);\n    a->s = (ares_socket_t)i+1;\n    EXPECT_NE((void *)NULL, ares_llist_insert_last(l, a));\n    EXPECT_TRUE(ares_htable_asvp_insert(h, a->s, a));\n  }\n\n  EXPECT_EQ(ASVP_TABLE_SIZE, ares_llist_len(l));\n  EXPECT_EQ(ASVP_TABLE_SIZE, ares_htable_asvp_num_keys(h));\n\n  n = ares_llist_node_first(l);\n  EXPECT_NE((void *)NULL, n);\n  while (n != NULL) {\n    ares_llist_node_t *next = ares_llist_node_next(n);\n    test_htable_asvp_t *a    = (test_htable_asvp_t *)ares_llist_node_val(n);\n    EXPECT_NE((void *)NULL, a);\n    EXPECT_EQ(a, ares_htable_asvp_get_direct(h, a->s));\n    EXPECT_TRUE(ares_htable_asvp_get(h, a->s, NULL));\n    EXPECT_TRUE(ares_htable_asvp_remove(h, a->s));\n    ares_llist_node_destroy(n);\n    n = next;\n  }\n\n  EXPECT_EQ(0, ares_llist_len(l));\n  EXPECT_EQ(0, ares_htable_asvp_num_keys(h));\n\n  ares_llist_destroy(l);\n  ares_htable_asvp_destroy(h);\n}",
      "fn_code_pos": [
        [
          1570,
          0
        ],
        [
          1613,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableSzvp) {\n  ares_llist_t       *l = NULL;\n  ares_htable_szvp_t *h = NULL;\n  ares_llist_node_t  *n = NULL;\n  size_t               i;\n\n#define SZVP_TABLE_SIZE 1000\n\n  l = ares_llist_create(NULL);\n  EXPECT_NE((void *)NULL, l);\n\n  h = ares_htable_szvp_create(ares_free);\n  EXPECT_NE((void *)NULL, h);\n\n  for (i=0; i<SZVP_TABLE_SIZE; i++) {\n    test_htable_szvp_t *s = (test_htable_szvp_t *)ares_malloc_zero(sizeof(*s));\n    EXPECT_NE((void *)NULL, s);\n    s->s = i+1;\n    EXPECT_NE((void *)NULL, ares_llist_insert_last(l, s));\n    EXPECT_TRUE(ares_htable_szvp_insert(h, s->s, s));\n  }\n\n  EXPECT_EQ(SZVP_TABLE_SIZE, ares_llist_len(l));\n  EXPECT_EQ(SZVP_TABLE_SIZE, ares_htable_szvp_num_keys(h));\n\n  n = ares_llist_node_first(l);\n  EXPECT_NE((void *)NULL, n);\n  while (n != NULL) {\n    ares_llist_node_t *next = ares_llist_node_next(n);\n    test_htable_szvp_t *s    = (test_htable_szvp_t *)ares_llist_node_val(n);\n    EXPECT_NE((void *)NULL, s);\n    EXPECT_EQ(s, ares_htable_szvp_get_direct(h, s->s));\n    EXPECT_TRUE(ares_htable_szvp_get(h, s->s, NULL));\n    EXPECT_TRUE(ares_htable_szvp_remove(h, s->s));\n    ares_llist_node_destroy(n);\n    n = next;\n  }\n\n  EXPECT_EQ(0, ares_llist_len(l));\n  EXPECT_EQ(0, ares_htable_szvp_num_keys(h));\n\n  ares_llist_destroy(l);\n  ares_htable_szvp_destroy(h);\n}",
      "fn_code_pos": [
        [
          1620,
          0
        ],
        [
          1663,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableVpstr) {\n  ares_llist_t        *l = NULL;\n  ares_htable_vpstr_t *h = NULL;\n  ares_llist_node_t   *n = NULL;\n  size_t                i;\n\n#define VPSTR_TABLE_SIZE 1000\n\n  l = ares_llist_create(ares_free);\n  EXPECT_NE((void *)NULL, l);\n\n  h = ares_htable_vpstr_create();\n  EXPECT_NE((void *)NULL, h);\n\n  for (i=0; i<VPSTR_TABLE_SIZE; i++) {\n    test_htable_vpstr_t *s = (test_htable_vpstr_t *)ares_malloc_zero(sizeof(*s));\n    EXPECT_NE((void *)NULL, s);\n    snprintf(s->s, sizeof(s->s), \"%d\", (int)i);\n    EXPECT_NE((void *)NULL, ares_llist_insert_last(l, s));\n    EXPECT_TRUE(ares_htable_vpstr_insert(h, s, s->s));\n  }\n\n  EXPECT_EQ(VPSTR_TABLE_SIZE, ares_llist_len(l));\n  EXPECT_EQ(VPSTR_TABLE_SIZE, ares_htable_vpstr_num_keys(h));\n\n  n = ares_llist_node_first(l);\n  EXPECT_NE((void *)NULL, n);\n  while (n != NULL) {\n    ares_llist_node_t *next = ares_llist_node_next(n);\n    test_htable_vpstr_t *s   = (test_htable_vpstr_t *)ares_llist_node_val(n);\n    EXPECT_NE((void *)NULL, s);\n    EXPECT_STREQ(s->s, ares_htable_vpstr_get_direct(h, s));\n    EXPECT_TRUE(ares_htable_vpstr_get(h, s, NULL));\n    EXPECT_TRUE(ares_htable_vpstr_remove(h, s));\n    ares_llist_node_destroy(n);\n    n = next;\n  }\n\n  EXPECT_EQ(0, ares_llist_len(l));\n  EXPECT_EQ(0, ares_htable_vpstr_num_keys(h));\n\n  ares_llist_destroy(l);\n  ares_htable_vpstr_destroy(h);\n}",
      "fn_code_pos": [
        [
          1669,
          0
        ],
        [
          1712,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableStrvp) {\n  ares_llist_t        *l = NULL;\n  ares_htable_strvp_t *h = NULL;\n  ares_llist_node_t   *n = NULL;\n  size_t                i;\n\n#define STRVP_TABLE_SIZE 1000\n\n  l = ares_llist_create(NULL);\n  EXPECT_NE((void *)NULL, l);\n\n  h = ares_htable_strvp_create(ares_free);\n  EXPECT_NE((void *)NULL, h);\n\n  for (i=0; i<STRVP_TABLE_SIZE; i++) {\n    test_htable_strvp_t *s = (test_htable_strvp_t *)ares_malloc_zero(sizeof(*s));\n    EXPECT_NE((void *)NULL, s);\n    snprintf(s->s, sizeof(s->s), \"%d\", (int)i);\n    EXPECT_NE((void *)NULL, ares_llist_insert_last(l, s));\n    EXPECT_TRUE(ares_htable_strvp_insert(h, s->s, s));\n  }\n\n  EXPECT_EQ(STRVP_TABLE_SIZE, ares_llist_len(l));\n  EXPECT_EQ(STRVP_TABLE_SIZE, ares_htable_strvp_num_keys(h));\n\n  n = ares_llist_node_first(l);\n  EXPECT_NE((void *)NULL, n);\n  while (n != NULL) {\n    ares_llist_node_t *next = ares_llist_node_next(n);\n    test_htable_strvp_t *s   = (test_htable_strvp_t *)ares_llist_node_val(n);\n    EXPECT_NE((void *)NULL, s);\n    EXPECT_EQ(s, ares_htable_strvp_get_direct(h, s->s));\n    EXPECT_TRUE(ares_htable_strvp_get(h, s->s, NULL));\n    EXPECT_TRUE(ares_htable_strvp_remove(h, s->s));\n    ares_llist_node_destroy(n);\n    n = next;\n  }\n\n  EXPECT_EQ(0, ares_llist_len(l));\n  EXPECT_EQ(0, ares_htable_strvp_num_keys(h));\n\n  ares_llist_destroy(l);\n  ares_htable_strvp_destroy(h);\n}",
      "fn_code_pos": [
        [
          1719,
          0
        ],
        [
          1762,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(LibraryTest, HtableDict) {\n  ares_htable_dict_t  *h = NULL;\n  size_t               i;\n  char               **keys;\n  size_t               nkeys;\n\n#define DICT_TABLE_SIZE 1000\n\n  h = ares_htable_dict_create();\n  EXPECT_NE((void *)NULL, h);\n\n  for (i=0; i<DICT_TABLE_SIZE; i++) {\n    char key[32];\n    char val[32];\n    snprintf(key, sizeof(key), \"%d\", (int)i);\n    snprintf(val, sizeof(val), \"val%d\", (int)i);\n    EXPECT_TRUE(ares_htable_dict_insert(h, key, val));\n  }\n\n  EXPECT_EQ(DICT_TABLE_SIZE, ares_htable_dict_num_keys(h));\n\n  keys = ares_htable_dict_keys(h, &nkeys);\n  for (i=0; i<nkeys; i++) {\n    char val[32];\n    snprintf(val, sizeof(val), \"val%s\", keys[i]);\n    EXPECT_STREQ(val, ares_htable_dict_get_direct(h, keys[i]));\n    EXPECT_TRUE(ares_htable_dict_get(h, keys[i], NULL));\n    EXPECT_TRUE(ares_htable_dict_remove(h, keys[i]));\n  }\n  ares_free_array(keys, nkeys, ares_free);\n\n  EXPECT_EQ(0, ares_htable_dict_num_keys(h));\n\n  ares_htable_dict_destroy(h);\n}",
      "fn_code_pos": [
        [
          1764,
          0
        ],
        [
          1798,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST_F(DefaultChannelTest, SaveInvalidChannel) {\n  ares_slist_t *saved = channel_->servers;\n  channel_->servers = NULL;\n  struct ares_options opts;\n  int optmask = 0;\n  EXPECT_EQ(ARES_ENODATA, ares_save_options(channel_, &opts, &optmask));\n  channel_->servers = saved;\n}",
      "fn_code_pos": [
        [
          1800,
          0
        ],
        [
          1807,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST_F",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "static int configure_socket(ares_socket_t s) {\n  // transposed from ares-process, simplified non-block setter.\n#if defined(USE_BLOCKING_SOCKETS)\n  return 0; /* returns success */\n#elif defined(HAVE_FCNTL_O_NONBLOCK)\n  /* most recent unix versions */\n  int flags;\n  flags = fcntl(s, F_GETFL, 0);\n  return fcntl(s, F_SETFL, flags | O_NONBLOCK);\n#elif defined(HAVE_IOCTL_FIONBIO)\n  /* older unix versions */\n  int flags = 1;\n  return ioctl(s, FIONBIO, &flags);\n#elif defined(HAVE_IOCTLSOCKET_FIONBIO)\n#ifdef WATT32\n  char flags = 1;\n#else\n  /* Windows */\n  unsigned long flags = 1UL;\n#endif\n  return ioctlsocket(s, (long)FIONBIO, &flags);\n#elif defined(HAVE_IOCTLSOCKET_CAMEL_FIONBIO)\n  /* Amiga */\n  long flags = 1L;\n  return IoctlSocket(s, FIONBIO, flags);\n#elif defined(HAVE_SETSOCKOPT_SO_NONBLOCK)\n  /* BeOS */\n  long b = 1L;\n  return setsockopt(s, SOL_SOCKET, SO_NONBLOCK, &b, sizeof(b));\n#else\n#  error \"no non-blocking method was found/used/set\"\n#endif\n}",
      "fn_code_pos": [
        [
          1811,
          0
        ],
        [
          1843,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "configure_socket",
        "parameters": {
          "s": "ares_socket_t"
        },
        "return_type": "int"
      }
    }
  ],
  "fn_declaraion": [],
  "class_node_list": {},
  "struct_node_list": [
    [
      "struct {\n    vector<string> inputs;\n    vector<string> delimiters;\n    vector<vector<string>> expected;\n  }",
      {
        "inputs": "vector<string>",
        "delimiters": "vector<string>",
        "expected": "vector<vector<string>>"
      },
      "",
      [
        100,
        2
      ],
      [
        104,
        3
      ]
    ],
    [
      "struct {\n    ares_bool_t success;\n    const char *uri;\n    const char *alt_match_uri;\n  }",
      {
        "success": "ares_bool_t",
        "char": "const"
      },
      "",
      [
        374,
        2
      ],
      [
        378,
        3
      ]
    ],
    [
      "typedef struct {\n  unsigned int id;\n  ares_buf_t *buf;\n} array_member_t;",
      {
        "id": "unsigned int",
        "*buf": "ares_buf_t"
      },
      "array_member_t",
      [
        1322,
        0
      ],
      [
        1325,
        17
      ]
    ],
    [
      "struct {\n    const char *input;\n    const char *srch;\n    const char *rplc;\n    const char *output;\n  }",
      {
        "char": "const"
      },
      "",
      [
        1541,
        2
      ],
      [
        1546,
        3
      ]
    ],
    [
      "typedef struct {\n  ares_socket_t s;\n} test_htable_asvp_t;",
      {
        "s": "ares_socket_t"
      },
      "test_htable_asvp_t",
      [
        1566,
        0
      ],
      [
        1568,
        21
      ]
    ],
    [
      "typedef struct {\n  size_t s;\n} test_htable_szvp_t;",
      {
        "s": "size_t"
      },
      "test_htable_szvp_t",
      [
        1616,
        0
      ],
      [
        1618,
        21
      ]
    ],
    [
      "typedef struct {\n  char s[32];\n} test_htable_vpstr_t;",
      {
        "s[32]": "char"
      },
      "test_htable_vpstr_t",
      [
        1665,
        0
      ],
      [
        1667,
        22
      ]
    ],
    [
      "typedef struct {\n  char s[32];\n} test_htable_strvp_t;",
      {
        "s[32]": "char"
      },
      "test_htable_strvp_t",
      [
        1715,
        0
      ],
      [
        1717,
        22
      ]
    ],
    [
      "struct in_addr",
      {},
      "",
      [
        88,
        2
      ],
      [
        88,
        16
      ]
    ],
    [
      "struct {\n    vector<string> inputs;\n    vector<string> delimiters;\n    vector<vector<string>> expected;\n  }",
      {
        "inputs": "vector<string>",
        "delimiters": "vector<string>",
        "expected": "vector<vector<string>>"
      },
      "",
      [
        100,
        2
      ],
      [
        104,
        3
      ]
    ],
    [
      "struct in_addr",
      {},
      "",
      [
        137,
        2
      ],
      [
        137,
        16
      ]
    ],
    [
      "struct in6_addr",
      {},
      "",
      [
        138,
        2
      ],
      [
        138,
        17
      ]
    ],
    [
      "struct ares_addr_node",
      {},
      "",
      [
        247,
        2
      ],
      [
        247,
        23
      ]
    ],
    [
      "struct ares_addr_node",
      {},
      "",
      [
        249,
        4
      ],
      [
        249,
        25
      ]
    ],
    [
      "struct ares_addr_node",
      {},
      "",
      [
        249,
        35
      ],
      [
        249,
        56
      ]
    ],
    [
      "struct ares_data",
      {},
      "",
      [
        259,
        26
      ],
      [
        259,
        42
      ]
    ],
    [
      "struct {\n    ares_bool_t success;\n    const char *uri;\n    const char *alt_match_uri;\n  }",
      {
        "success": "ares_bool_t",
        "char": "const"
      },
      "",
      [
        374,
        2
      ],
      [
        378,
        3
      ]
    ],
    [
      "struct in_addr",
      {},
      "",
      [
        477,
        2
      ],
      [
        477,
        16
      ]
    ],
    [
      "struct in6_addr",
      {},
      "",
      [
        478,
        2
      ],
      [
        478,
        17
      ]
    ],
    [
      "struct ares_data",
      {},
      "",
      [
        489,
        2
      ],
      [
        489,
        18
      ]
    ],
    [
      "struct ares_data",
      {},
      "",
      [
        489,
        28
      ],
      [
        489,
        44
      ]
    ],
    [
      "struct ares_data",
      {},
      "",
      [
        489,
        61
      ],
      [
        489,
        77
      ]
    ],
    [
      "struct ares_addrinfo_hints",
      {},
      "",
      [
        530,
        2
      ],
      [
        530,
        28
      ]
    ],
    [
      "struct ares_addrinfo_hints",
      {},
      "",
      [
        550,
        2
      ],
      [
        550,
        28
      ]
    ],
    [
      "struct ares_addrinfo_hints",
      {},
      "",
      [
        570,
        2
      ],
      [
        570,
        28
      ]
    ],
    [
      "struct ares_addrinfo_hints",
      {},
      "",
      [
        590,
        2
      ],
      [
        590,
        28
      ]
    ],
    [
      "struct ares_addrinfo_hints",
      {},
      "",
      [
        605,
        2
      ],
      [
        605,
        28
      ]
    ],
    [
      "struct ares_addrinfo_hints",
      {},
      "",
      [
        618,
        2
      ],
      [
        618,
        28
      ]
    ],
    [
      "struct in_addr",
      {},
      "",
      [
        647,
        2
      ],
      [
        647,
        16
      ]
    ],
    [
      "struct ares_in6_addr",
      {},
      "",
      [
        648,
        2
      ],
      [
        648,
        22
      ]
    ],
    [
      "struct ares_addr",
      {},
      "",
      [
        832,
        2
      ],
      [
        832,
        18
      ]
    ],
    [
      "struct in_addr",
      {},
      "",
      [
        1104,
        2
      ],
      [
        1104,
        16
      ]
    ],
    [
      "typedef struct {\n  unsigned int id;\n  ares_buf_t *buf;\n} array_member_t;",
      {
        "id": "unsigned int",
        "*buf": "ares_buf_t"
      },
      "array_member_t",
      [
        1322,
        0
      ],
      [
        1325,
        17
      ]
    ],
    [
      "struct {\n    const char *input;\n    const char *srch;\n    const char *rplc;\n    const char *output;\n  }",
      {
        "char": "const"
      },
      "",
      [
        1541,
        2
      ],
      [
        1546,
        3
      ]
    ],
    [
      "typedef struct {\n  ares_socket_t s;\n} test_htable_asvp_t;",
      {
        "s": "ares_socket_t"
      },
      "test_htable_asvp_t",
      [
        1566,
        0
      ],
      [
        1568,
        21
      ]
    ],
    [
      "typedef struct {\n  size_t s;\n} test_htable_szvp_t;",
      {
        "s": "size_t"
      },
      "test_htable_szvp_t",
      [
        1616,
        0
      ],
      [
        1618,
        21
      ]
    ],
    [
      "typedef struct {\n  char s[32];\n} test_htable_vpstr_t;",
      {
        "s[32]": "char"
      },
      "test_htable_vpstr_t",
      [
        1665,
        0
      ],
      [
        1667,
        22
      ]
    ],
    [
      "typedef struct {\n  char s[32];\n} test_htable_strvp_t;",
      {
        "s[32]": "char"
      },
      "test_htable_strvp_t",
      [
        1715,
        0
      ],
      [
        1717,
        22
      ]
    ],
    [
      "struct ares_options",
      {},
      "",
      [
        1803,
        2
      ],
      [
        1803,
        21
      ]
    ],
    [
      "struct ares_socket_functions",
      {},
      "",
      [
        1847,
        6
      ],
      [
        1847,
        34
      ]
    ]
  ],
  "include_list": [
    [
      "#include \"ares-test.h\"\n",
      [
        25,
        0
      ],
      [
        26,
        0
      ]
    ],
    [
      "#include \"dns-proto.h\"\n",
      [
        26,
        0
      ],
      [
        27,
        0
      ]
    ],
    [
      "#include <stdio.h>\n",
      [
        28,
        0
      ],
      [
        29,
        0
      ]
    ],
    [
      "#include <unistd.h>\n",
      [
        31,
        0
      ],
      [
        32,
        0
      ]
    ],
    [
      "#include <fcntl.h>\n",
      [
        33,
        0
      ],
      [
        34,
        0
      ]
    ],
    [
      "#  include <sys/ioctl.h>\n",
      [
        35,
        0
      ],
      [
        36,
        0
      ]
    ],
    [
      "#include \"ares_private.h\"\n",
      [
        44,
        0
      ],
      [
        45,
        0
      ]
    ],
    [
      "#include \"ares_inet_net_pton.h\"\n",
      [
        45,
        0
      ],
      [
        46,
        0
      ]
    ],
    [
      "#include \"ares_data.h\"\n",
      [
        46,
        0
      ],
      [
        47,
        0
      ]
    ],
    [
      "#include \"str/ares_strsplit.h\"\n",
      [
        47,
        0
      ],
      [
        48,
        0
      ]
    ],
    [
      "#include \"dsa/ares_htable.h\"\n",
      [
        48,
        0
      ],
      [
        49,
        0
      ]
    ],
    [
      "#include <arpa/inet.h>\n",
      [
        51,
        0
      ],
      [
        52,
        0
      ]
    ],
    [
      "#  include <sys/uio.h>\n",
      [
        54,
        0
      ],
      [
        55,
        0
      ]
    ],
    [
      "#include <string>\n",
      [
        58,
        0
      ],
      [
        59,
        0
      ]
    ],
    [
      "#include <vector>\n",
      [
        59,
        0
      ],
      [
        60,
        0
      ]
    ]
  ],
  "global_variables": [],
  "enumerate_node_list": []
}