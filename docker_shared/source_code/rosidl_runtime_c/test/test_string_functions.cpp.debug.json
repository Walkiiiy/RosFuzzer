{
  "fn_def_list": [
    {
      "fn_code": "TEST(string_functions, init_fini_empty_string) {\n  rosidl_runtime_c__String empty_string;\n  EXPECT_TRUE(rosidl_runtime_c__String__init(&empty_string));\n  EXPECT_EQ(empty_string.size, 0u);\n  EXPECT_EQ(empty_string.capacity, 1u);\n  EXPECT_EQ(empty_string.data[0], 0);\n\n  // Should just return without changing anything.\n  rosidl_runtime_c__String__fini(nullptr);\n\n  rosidl_runtime_c__String__fini(&empty_string);\n  EXPECT_EQ(empty_string.data, nullptr);\n  EXPECT_EQ(empty_string.size, 0u);\n  EXPECT_EQ(empty_string.capacity, 0u);\n}",
      "fn_code_pos": [
        [
          20,
          0
        ],
        [
          34,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(string_functions, init_fini_bad_data) {\n  EXPECT_FALSE(rosidl_runtime_c__String__init(nullptr));\n\n  rosidl_runtime_c__String bad_string;\n  bad_string.size = 1u;\n  bad_string.capacity = 1u;\n  bad_string.data = nullptr;\n\n  int expected_error_code = -1;\n#ifndef _WIN32\n  // While exit() takes an int, when a parent process waits for a child process to die, it only\n  // takes the lowest 8-bits.\n  // See Note: in https://pubs.opengroup.org/onlinepubs/009695399/functions/exit.html\n  expected_error_code &= 255;\n#endif\n  EXPECT_EXIT(\n    rosidl_runtime_c__String__fini(&bad_string),\n    ::testing::ExitedWithCode(expected_error_code),\n    \"Unexpected condition: string size was non-zero for deallocated data! Exiting.\");\n  bad_string.size = 0u;\n\n  EXPECT_EXIT(\n    rosidl_runtime_c__String__fini(&bad_string),\n    ::testing::ExitedWithCode(expected_error_code),\n    \"Unexpected behavior: string capacity was non-zero for deallocated data! Exiting.\");\n\n  char c = 0;\n  bad_string.data = &c;\n  bad_string.capacity = 0u;\n\n  EXPECT_EXIT(\n    rosidl_runtime_c__String__fini(&bad_string),\n    ::testing::ExitedWithCode(expected_error_code),\n    \"Unexpected condition: string capacity was zero for allocated data! Exiting.\");\n}",
      "fn_code_pos": [
        [
          36,
          0
        ],
        [
          70,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(string_functions, resize_assignn) {\n  rosidl_runtime_c__String s, t;\n  constexpr size_t s_size = 3u;\n  constexpr char data[s_size + 1] = {3u, 2u, 1u, 0u};\n\n  EXPECT_TRUE(rosidl_runtime_c__String__init(&s));\n  EXPECT_TRUE(rosidl_runtime_c__String__init(&t));\n\n  EXPECT_FALSE(rosidl_runtime_c__String__assign(nullptr, nullptr));\n  EXPECT_FALSE(rosidl_runtime_c__String__assignn(nullptr, nullptr, 0));\n  EXPECT_FALSE(rosidl_runtime_c__String__assignn(&s, nullptr, 0));\n  EXPECT_FALSE(rosidl_runtime_c__String__assignn(nullptr, &data[0], 0));\n\n  EXPECT_TRUE(rosidl_runtime_c__String__assign(&s, &data[0]));\n  EXPECT_EQ(s.size, s_size);\n  EXPECT_EQ(s.capacity, s_size + 1u);\n  EXPECT_EQ(s.data[0], data[0]);\n  EXPECT_EQ(s.data[1], data[1]);\n  EXPECT_EQ(s.data[2], data[2]);\n  EXPECT_EQ(s.data[3], 0);\n\n  EXPECT_TRUE(rosidl_runtime_c__String__assignn(&t, &data[0], s_size));\n  EXPECT_EQ(t.size, s_size);\n  EXPECT_EQ(t.capacity, s_size + 1u);\n  EXPECT_EQ(t.data[0], data[0]);\n  EXPECT_EQ(t.data[1], data[1]);\n  EXPECT_EQ(t.data[2], data[2]);\n  EXPECT_EQ(t.data[3], 0);\n\n  // Can't copy strings of size max\n  EXPECT_FALSE(rosidl_runtime_c__String__assignn(&s, &data[0], SIZE_MAX));\n\n  // Check assigning 0-length strings\n  EXPECT_TRUE(rosidl_runtime_c__String__assignn(&s, &data[0], 0));\n  EXPECT_EQ(s.size, 0u);\n  EXPECT_EQ(s.capacity, 1u);\n  EXPECT_EQ(s.data[0], 0);\n\n  rosidl_runtime_c__String__fini(&s);\n  rosidl_runtime_c__String__fini(&t);\n\n  // Check assign after fini without init\n  EXPECT_TRUE(rosidl_runtime_c__String__assign(&s, &data[0]));\n  rosidl_runtime_c__String__fini(&s);\n}",
      "fn_code_pos": [
        [
          72,
          0
        ],
        [
          116,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(string_functions, equality_comparison) {\n  rosidl_runtime_c__String empty_string, foo_string, bar_string;\n  EXPECT_TRUE(rosidl_runtime_c__String__init(&empty_string));\n  EXPECT_TRUE(rosidl_runtime_c__String__init(&foo_string));\n  EXPECT_TRUE(rosidl_runtime_c__String__assign(&foo_string, \"foo\"));\n  EXPECT_TRUE(rosidl_runtime_c__String__init(&bar_string));\n  EXPECT_TRUE(rosidl_runtime_c__String__assign(&bar_string, \"bar\"));\n\n  EXPECT_FALSE(rosidl_runtime_c__String__are_equal(nullptr, nullptr));\n  EXPECT_FALSE(rosidl_runtime_c__String__are_equal(&empty_string, nullptr));\n  EXPECT_FALSE(rosidl_runtime_c__String__are_equal(nullptr, &empty_string));\n  EXPECT_TRUE(rosidl_runtime_c__String__are_equal(&empty_string, &empty_string));\n\n  EXPECT_FALSE(rosidl_runtime_c__String__are_equal(&empty_string, &foo_string));\n  EXPECT_FALSE(rosidl_runtime_c__String__are_equal(&foo_string, &empty_string));\n  EXPECT_TRUE(rosidl_runtime_c__String__are_equal(&foo_string, &foo_string));\n\n  EXPECT_FALSE(rosidl_runtime_c__String__are_equal(&bar_string, &foo_string));\n  EXPECT_FALSE(rosidl_runtime_c__String__are_equal(&foo_string, &bar_string));\n  EXPECT_TRUE(rosidl_runtime_c__String__are_equal(&bar_string, &bar_string));\n\n  rosidl_runtime_c__String__fini(&bar_string);\n  rosidl_runtime_c__String__fini(&foo_string);\n  rosidl_runtime_c__String__fini(&empty_string);\n}",
      "fn_code_pos": [
        [
          118,
          0
        ],
        [
          142,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(string_functions, copy) {\n  rosidl_runtime_c__String input, output;\n\n  EXPECT_FALSE(rosidl_runtime_c__String__copy(nullptr, nullptr));\n  EXPECT_FALSE(rosidl_runtime_c__String__copy(&input, nullptr));\n  EXPECT_FALSE(rosidl_runtime_c__String__copy(nullptr, &output));\n\n  EXPECT_TRUE(rosidl_runtime_c__String__init(&input));\n  EXPECT_TRUE(rosidl_runtime_c__String__assign(&input, \"foo\"));\n  EXPECT_TRUE(rosidl_runtime_c__String__init(&output));\n\n  EXPECT_FALSE(rosidl_runtime_c__String__are_equal(&input, &output));\n  EXPECT_TRUE(rosidl_runtime_c__String__copy(&input, &output));\n  EXPECT_TRUE(rosidl_runtime_c__String__are_equal(&input, &output));\n\n  rosidl_runtime_c__String__fini(&output);\n  rosidl_runtime_c__String__fini(&input);\n}",
      "fn_code_pos": [
        [
          144,
          0
        ],
        [
          161,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(string_functions, init_fini_sequence) {\n  rosidl_runtime_c__String__Sequence sequence;\n  EXPECT_FALSE(rosidl_runtime_c__String__Sequence__init(nullptr, 0u));\n  EXPECT_TRUE(rosidl_runtime_c__String__Sequence__init(&sequence, 0u));\n\n  EXPECT_EQ(sequence.size, 0u);\n  EXPECT_EQ(sequence.capacity, 0u);\n  EXPECT_EQ(sequence.data, nullptr);\n\n  // Checking these return without issue\n  rosidl_runtime_c__String__Sequence__fini(nullptr);\n  rosidl_runtime_c__String__Sequence__fini(&sequence);\n\n  constexpr size_t seq_size = 3u;\n  EXPECT_TRUE(rosidl_runtime_c__String__Sequence__init(&sequence, seq_size));\n  EXPECT_EQ(sequence.size, seq_size);\n  EXPECT_EQ(sequence.capacity, seq_size);\n  rosidl_runtime_c__String__Sequence__fini(&sequence);\n}",
      "fn_code_pos": [
        [
          163,
          0
        ],
        [
          181,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(string_functions, create_destroy_sequence) {\n  rosidl_runtime_c__String__Sequence * sequence =\n    rosidl_runtime_c__String__Sequence__create(0u);\n  EXPECT_NE(sequence, nullptr);\n  EXPECT_EQ(sequence->data, nullptr);\n  EXPECT_EQ(sequence->size, 0u);\n  EXPECT_EQ(sequence->capacity, 0u);\n\n  // Shouldn't do anything exciting\n  rosidl_runtime_c__String__Sequence__destroy(sequence);\n\n  constexpr size_t seq_size = 3u;\n  sequence = rosidl_runtime_c__String__Sequence__create(seq_size);\n  EXPECT_NE(sequence, nullptr);\n  EXPECT_EQ(sequence->size, seq_size);\n  EXPECT_EQ(sequence->capacity, seq_size);\n  rosidl_runtime_c__String__Sequence__destroy(sequence);\n}",
      "fn_code_pos": [
        [
          183,
          0
        ],
        [
          200,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(string_functions, create_destroy_sequence_maybe_fail) {\n  rosidl_runtime_c__String__Sequence * sequence = nullptr;\n  constexpr size_t seq_size = 10u;\n\n  RCUTILS_FAULT_INJECTION_TEST(\n  {\n    sequence = rosidl_runtime_c__String__Sequence__create(seq_size);\n    if (nullptr != sequence) {\n      rosidl_runtime_c__String__Sequence__destroy(sequence);\n      sequence = nullptr;\n    }\n  });\n}",
      "fn_code_pos": [
        [
          202,
          0
        ],
        [
          214,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(string_functions, sequence_equality_comparison) {\n  rosidl_runtime_c__String__Sequence empty_sequence;\n  rosidl_runtime_c__String__Sequence nonempty_sequence;\n  EXPECT_TRUE(rosidl_runtime_c__String__Sequence__init(&empty_sequence, 0u));\n  EXPECT_TRUE(rosidl_runtime_c__String__Sequence__init(&nonempty_sequence, 1u));\n\n  EXPECT_FALSE(rosidl_runtime_c__String__Sequence__are_equal(nullptr, nullptr));\n  EXPECT_FALSE(rosidl_runtime_c__String__Sequence__are_equal(&empty_sequence, nullptr));\n  EXPECT_FALSE(rosidl_runtime_c__String__Sequence__are_equal(nullptr, &empty_sequence));\n  EXPECT_TRUE(rosidl_runtime_c__String__Sequence__are_equal(&empty_sequence, &empty_sequence));\n  EXPECT_FALSE(rosidl_runtime_c__String__Sequence__are_equal(&empty_sequence, &nonempty_sequence));\n  EXPECT_FALSE(rosidl_runtime_c__String__Sequence__are_equal(&nonempty_sequence, &empty_sequence));\n  EXPECT_TRUE(\n    rosidl_runtime_c__String__Sequence__are_equal(\n      &nonempty_sequence,\n      &nonempty_sequence));\n\n  rosidl_runtime_c__String__Sequence__fini(&empty_sequence);\n  rosidl_runtime_c__String__Sequence__fini(&nonempty_sequence);\n}",
      "fn_code_pos": [
        [
          216,
          0
        ],
        [
          235,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    },
    {
      "fn_code": "TEST(string_functions, copy_sequence) {\n  rosidl_runtime_c__String__Sequence input, output;\n\n  EXPECT_FALSE(rosidl_runtime_c__String__Sequence__copy(nullptr, nullptr));\n  EXPECT_FALSE(rosidl_runtime_c__String__Sequence__copy(&input, nullptr));\n  EXPECT_FALSE(rosidl_runtime_c__String__Sequence__copy(nullptr, &output));\n\n  EXPECT_TRUE(rosidl_runtime_c__String__Sequence__init(&input, 1u));\n  EXPECT_TRUE(rosidl_runtime_c__String__assign(&input.data[0], \"foo\"));\n  EXPECT_TRUE(rosidl_runtime_c__String__Sequence__init(&output, 0u));\n\n  EXPECT_FALSE(rosidl_runtime_c__String__Sequence__are_equal(&input, &output));\n  EXPECT_TRUE(rosidl_runtime_c__String__Sequence__copy(&input, &output));\n  EXPECT_TRUE(rosidl_runtime_c__String__Sequence__are_equal(&input, &output));\n\n  rosidl_runtime_c__String__Sequence__fini(&output);\n  rosidl_runtime_c__String__Sequence__fini(&input);\n}",
      "fn_code_pos": [
        [
          237,
          0
        ],
        [
          254,
          1
        ]
      ],
      "class_code": "",
      "class_node_pos": [],
      "fn_meta": {
        "identifier": "TEST",
        "parameters": {},
        "return_type": null
      }
    }
  ],
  "fn_declaraion": [],
  "class_node_list": {},
  "struct_node_list": [],
  "include_list": [
    [
      "#include \"gtest/gtest.h\"\n",
      [
        14,
        0
      ],
      [
        15,
        0
      ]
    ],
    [
      "#include \"rosidl_runtime_c/string.h\"\n",
      [
        15,
        0
      ],
      [
        16,
        0
      ]
    ],
    [
      "#include \"rosidl_runtime_c/string_functions.h\"\n",
      [
        16,
        0
      ],
      [
        17,
        0
      ]
    ],
    [
      "#include \"rcutils/testing/fault_injection.h\"\n",
      [
        18,
        0
      ],
      [
        19,
        0
      ]
    ]
  ],
  "global_variables": [],
  "enumerate_node_list": []
}